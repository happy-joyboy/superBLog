<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Content & File Providers &#183; JoyBoy</title><meta name=title content="Content & File Providers &#183; JoyBoy"><meta name=description content="My awesome website"><meta name=keywords content="Summary,Andorid,contnet provider,file provider,"><link rel=canonical href=https://happy-joyboy.github.io/superBLog/posts/summary/providers/><link type=text/css rel=stylesheet href=/superBLog/css/main.bundle.min.3d1766b6cf56fd5f549e71c643e72f95996a0d3790e8368d1dbd155d23314019b2b18c90489fee52f016765c33073cb0f1d0158323f6f9b62f723d68ccd04b69.css integrity="sha512-PRdmts9W/V9UnnHGQ+cvlZlqDTeQ6DaNHb0VXSMxQBmysYyQSJ/uUvAWdlwzBzyw8dAVgyP2+bYvcj1ozNBLaQ=="><script type=text/javascript src=/superBLog/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/superBLog/js/main.bundle.min.98bb8ce8f123e03c4d2171eeec151dd404b5c476beb5ef1068d0e8b1a2afb923065e6552fc14b2d867c85ee4bd8529a43193f729f874d3908517ba03b5d1cc57.js integrity="sha512-mLuM6PEj4DxNIXHu7BUd1AS1xHa+te8QaNDosaKvuSMGXmVS/BSy2GfIXuS9hSmkMZP3Kfh005CFF7oDtdHMVw==" data-copy=Copy data-copied=Copied></script><script src=/superBLog/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/superBLog/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/superBLog/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/superBLog/favicon-16x16.png><link rel=manifest href=/superBLog/site.webmanifest><meta property="og:url" content="https://happy-joyboy.github.io/superBLog/posts/summary/providers/"><meta property="og:site_name" content="JoyBoy"><meta property="og:title" content="Content & File Providers"><meta property="og:description" content="My awesome website"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-30T00:55:36+03:00"><meta property="article:modified_time" content="2025-07-30T00:55:36+03:00"><meta property="article:tag" content="Summary"><meta property="article:tag" content="Andorid"><meta property="article:tag" content="Contnet Provider"><meta property="article:tag" content="File Provider"><meta name=twitter:card content="summary"><meta name=twitter:title content="Content & File Providers"><meta name=twitter:description content="My awesome website"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"Content \u0026 File Providers","headline":"Content \u0026 File Providers","inLanguage":"en","url":"https:\/\/happy-joyboy.github.io\/superBLog\/posts\/summary\/providers\/","author":{"@type":"Person","name":"Saeed Khalid"},"copyrightYear":"2025","dateCreated":"2025-07-30T00:55:36\u002b03:00","datePublished":"2025-07-30T00:55:36\u002b03:00","dateModified":"2025-07-30T00:55:36\u002b03:00","keywords":["Summary","Andorid","contnet provider","file provider"],"mainEntityOfPage":"true","wordCount":"4742"}]</script><meta name=author content="Saeed Khalid"><link href=https://github.com/happy-joyboy rel=me><link href=https://www.linkedin.com/in/saeed-khalid-awaad/ rel=me><link href=https://x.com/0badsecurity0 rel=me><link href=https://www.youtube.com/@joyboy_404 rel=me><script src=/superBLog/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 min-h-[130px] opacity-65 pl-[24px] pr-[24px] bg-gradient-to-b from-neutral from-60% dark:from-neutral-800 to-transparent mix-blend-normal z-80"></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div><a href=/superBLog/ class=flex><span class=sr-only>JoyBoy</span>
<img src=/superBLog/img/profile/imagesluffy.jpeg width=150 height=84 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=JoyBoy></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/superBLog/ class="text-base font-medium text-gray-500 hover:text-gray-900">JoyBoy</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/superBLog/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=JoyBoy>Home</p></a><a href=/superBLog/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Blog</p></a><a href=/superBLog/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Tags</p></a><a href=/superBLog/about/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=First>who am I?</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/superBLog/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=JoyBoy>Home</p></a></li><li class=mt-1><a href=/superBLog/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Blog</p></a></li><li class=mt-1><a href=/superBLog/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Tags</p></a></li><li class=mt-1><a href=/superBLog/about/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=First>who am I?</p></a></li></ul></div></div></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/superBLog/js/background-blur.min.78ad5090e7c0c2533bac9dd23bdb1f723f834e5c3626627bd31017cc139ce0651b529877862129cee49e380ab2fdcd8baef28ae3e086bc54957fdaa7758775b2.js integrity="sha512-eK1QkOfAwlM7rJ3SO9sfcj+DTlw2JmJ70xAXzBOc4GUbUph3hiEpzuSeOAqy/c2LrvKK4+CGvFSVf9qndYd1sg==" data-target-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/superBLog/img/profile/bleach_hu_aa1d93a24885f8fd.jpg)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/superBLog/js/background-blur.min.78ad5090e7c0c2533bac9dd23bdb1f723f834e5c3626627bd31017cc139ce0651b529877862129cee49e380ab2fdcd8baef28ae3e086bc54957fdaa7758775b2.js integrity="sha512-eK1QkOfAwlM7rJ3SO9sfcj+DTlw2JmJ70xAXzBOc4GUbUph3hiEpzuSeOAqy/c2LrvKK4+CGvFSVf9qndYd1sg==" data-target-id=background-blur></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/superBLog/>JoyBoy</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/superBLog/posts/>posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/superBLog/posts/summary/providers/>Content & File Providers</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Content & File Providers</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>4742 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">23 mins</span><span class="px-2 text-primary-500">&#183;</span>
<script type=text/javascript src=/superBLog/js/zen-mode.min.2a0a1375509c03daf41c53a9831aa2d560895b7a2528c3eb3b56e7b11a135c7529e49727162a053b6193be8340270a8342f42c69f3d7e262ae54bc248eaac8f5.js integrity="sha512-KgoTdVCcA9r0HFOpgxqi1WCJW3olKMPrO1bnsRoTXHUp5JcnFioFO2GTvoNAJwqDQvQsafPX4mKuVLwkjqrI9Q=="></script><span class=mb-[2px]><span id=zen-mode-button class="text-lg hover:text-primary-500" title="Enable zen mode" data-title-i18n-disable="Enable zen mode" data-title-i18n-enable="Disable zen mode"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/summary/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Summary
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/contnet-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Contnet Provider
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/file-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">File Provider</span></span></span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#summary>Summary</a><ul><li><a href=#what-is-a-file-provider>What is a File Provider?</a></li></ul></li><li><a href=#what-content-providers-look-like>What Content Providers Look Like</a><ul><li><a href=#core-components>Core Components</a><ul><li><a href=#1-provider-client-contentresolver>1. Provider Client (ContentResolver)</a></li><li><a href=#bonus-query-code>Bonus query code</a></li><li><a href=#2-provider-contentprovider-subclass>2. Provider (ContentProvider subclass)</a></li></ul></li></ul></li><li><a href=#built-in-content-providers>Built-in Content Providers</a></li><li><a href=#creating-custom-content-providers>Creating Custom Content Providers</a><ul><li><a href=#1-design-data-storage>1. Design Data Storage</a></li><li><a href=#example-of-a-db-that-is-prover-can-query>Example of a DB that is prover can query</a><ul><li><a href=#database-structure><strong>Database Structure</strong></a></li><li><a href=#flag-table-schema><strong>Flag Table Schema</strong></a></li><li><a href=#note-table-schema><strong>Note Table Schema</strong></a></li><li><a href=#flag-table-initial-entries><strong>Flag Table (Initial Entries)</strong></a></li><li><a href=#note-table-initial-entries><strong>Note Table (Initial Entries)</strong></a></li></ul></li><li><a href=#2-implement-contentprovider>2. Implement ContentProvider</a></li><li><a href=#3-define-metadata>3. Define Metadata</a></li><li><a href=#4-manifest-registration>4. Manifest Registration</a></li></ul></li><li><a href=#use-cases>Use Cases</a><ul><li><a href=#1--secure-data-sharing>1- Secure Data Sharing</a></li><li><a href=#2--data-abstraction>2- Data Abstraction</a></li><li><a href=#3--more-permission-control>3- More Permission Control</a></li><li><a href=#4--framework-integration>4- Framework Integration</a></li></ul></li><li><a href=#file-provider-implementation>File Provider Implementation</a><ul><li><a href=#how-content-providers-handle-files>How Content Providers Handle Files</a></li></ul></li><li><a href=#configuration--permissions>Configuration & Permissions</a><ul><li><a href=#manifest-declaration>Manifest Declaration</a></li><li><a href=#some-key-attributes>Some Key Attributes</a><ul><li><a href=#androidexported>android:exported</a></li><li><a href=#permission-levels>Permission Levels</a></li><li><a href=#temporary-uri-permissions>Temporary URI Permissions</a></li></ul></li></ul></li><li><a href=#data-types-and-mime-types>Data Types and MIME Types</a><ul><li><a href=#supported-data-types>Supported Data Types</a></li><li><a href=#mime-type-conventions>MIME Type Conventions</a></li></ul></li><li><a href=#common-vulnerabilities>Common Vulnerabilities</a><ul><li><a href=#1-overly-open-access-controls>1. Overly open Access Controls</a><ul><li><a href=#vulnerability>Vulnerability</a></li><li><a href=#vulnerable-code-example>Vulnerable Code Example</a></li><li><a href=#mitigation>Mitigation</a></li></ul></li><li><a href=#2-improperly-exposed-directories-to-fileprovider>2. Improperly Exposed Directories to FileProvider</a><ul><li><a href=#vulnerability-1>Vulnerability</a></li><li><a href=#attack>Attack</a></li><li><a href=#vulnerable-code-example-1>Vulnerable Code Example</a></li><li><a href=#mitigation-1>Mitigation</a></li></ul></li><li><a href=#3-path-traversal-when-using-data-from-uri>3. Path Traversal when using data from Uri</a><ul><li><a href=#vulnerability-2>Vulnerability</a></li><li><a href=#attack-1>Attack</a></li><li><a href=#vulnerable-code-example-2>Vulnerable Code Example</a></li><li><a href=#mitigation-2>Mitigation</a></li></ul></li><li><a href=#4-trusting-contentprovider-provided-filename>4. Trusting ContentProvider-Provided Filename</a><ul><li><a href=#vulnerability-3>Vulnerability</a></li><li><a href=#attack-2>Attack</a></li><li><a href=#vulnerable-code-example-3>Vulnerable Code Example</a></li><li><a href=#mitigation-3>Mitigation</a></li></ul></li><li><a href=#5-exploiting-implicit-intents-for-file-theft-and-overwriting>5. Exploiting Implicit Intents for File Theft and Overwriting</a><ul><li><a href=#vulnerability-4>Vulnerability</a></li><li><a href=#attack-for-file-theft>Attack for File Theft</a></li><li><a href=#attack-for-arbitrary-file-overwriting>Attack for Arbitrary File Overwriting</a></li><li><a href=#vulnerable-code-example-4>Vulnerable Code Example</a></li><li><a href=#mitigation-4>Mitigation</a></li></ul></li><li><a href=#6-proxying-requests-to-more-secure-providers>6. Proxying Requests to More Secure Providers</a><ul><li><a href=#vulnerability-5>Vulnerability</a></li><li><a href=#note-on-vulnerable-code-example>Note on Vulnerable Code Example</a></li><li><a href=#mitigation-5>Mitigation</a></li></ul></li><li><a href=#7-theft-of-arbitrary-files-via-file-choosers-in-webview>7. Theft of Arbitrary Files via File Choosers in WebView</a><ul><li><a href=#vulnerability-6>Vulnerability</a></li><li><a href=#attack-3>Attack</a></li><li><a href=#vulnerable-code-example-5>Vulnerable Code Example</a></li><li><a href=#mitigation-6>Mitigation</a></li></ul></li><li><a href=#8-gaining-access-via-intent-redirection-to-protected-components>8. Gaining Access via Intent Redirection to Protected Components</a><ul><li><a href=#vulnerability-7>Vulnerability</a></li><li><a href=#attack-4>Attack</a></li><li><a href=#vulnerable-code-example-6>Vulnerable Code Example</a></li><li><a href=#mitigation-7>Mitigation</a></li></ul></li><li><a href=#9-sql-injection-in-shared-databases>9. SQL Injection in Shared Databases</a><ul><li><a href=#vulnerability-8>Vulnerability</a></li><li><a href=#vulnerable-code-example-7>Vulnerable Code Example</a></li><li><a href=#mitigation-8>Mitigation</a></li></ul></li><li><a href=#10-zip-path-traversal-zipslip>10. Zip Path Traversal (ZipSlip)</a><ul><li><a href=#vulnerability-9>Vulnerability</a></li><li><a href=#attack-5>Attack</a></li><li><a href=#vulnerable-code-example-8>Vulnerable Code Example</a></li><li><a href=#mitigation-9>Mitigation</a></li></ul></li></ul></li><li><a href=#security--best-practices>Security & Best Practices</a><ul><li><a href=#permission-strategy>Permission Strategy</a><ul><li><a href=#restrict-access-through-permissions>Restrict Access Through Permissions</a></li></ul></li><li><a href=#secure-data-storage>Secure Data Storage</a></li><li><a href=#prevent-sql-injection>Prevent SQL Injection</a></li><li><a href=#implementation-best-practices>Implementation Best Practices</a><ul><li><a href=#thread-safety>Thread Safety</a></li><li><a href=#efficient-oncreate>Efficient onCreate()</a></li><li><a href=#contract-classes>Contract Classes</a></li></ul></li></ul></li><li><a href=#in-the-end>In The end</a></li><li><a href=#resources>Resources</a><ul><li><a href=#documentation>Documentation</a></li><li><a href=#security-resources>Security Resources</a></li><li><a href=#best-practices>Best Practices</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#summary>Summary</a><ul><li><a href=#what-is-a-file-provider>What is a File Provider?</a></li></ul></li><li><a href=#what-content-providers-look-like>What Content Providers Look Like</a><ul><li><a href=#core-components>Core Components</a><ul><li><a href=#1-provider-client-contentresolver>1. Provider Client (ContentResolver)</a></li><li><a href=#bonus-query-code>Bonus query code</a></li><li><a href=#2-provider-contentprovider-subclass>2. Provider (ContentProvider subclass)</a></li></ul></li></ul></li><li><a href=#built-in-content-providers>Built-in Content Providers</a></li><li><a href=#creating-custom-content-providers>Creating Custom Content Providers</a><ul><li><a href=#1-design-data-storage>1. Design Data Storage</a></li><li><a href=#example-of-a-db-that-is-prover-can-query>Example of a DB that is prover can query</a><ul><li><a href=#database-structure><strong>Database Structure</strong></a></li><li><a href=#flag-table-schema><strong>Flag Table Schema</strong></a></li><li><a href=#note-table-schema><strong>Note Table Schema</strong></a></li><li><a href=#flag-table-initial-entries><strong>Flag Table (Initial Entries)</strong></a></li><li><a href=#note-table-initial-entries><strong>Note Table (Initial Entries)</strong></a></li></ul></li><li><a href=#2-implement-contentprovider>2. Implement ContentProvider</a></li><li><a href=#3-define-metadata>3. Define Metadata</a></li><li><a href=#4-manifest-registration>4. Manifest Registration</a></li></ul></li><li><a href=#use-cases>Use Cases</a><ul><li><a href=#1--secure-data-sharing>1- Secure Data Sharing</a></li><li><a href=#2--data-abstraction>2- Data Abstraction</a></li><li><a href=#3--more-permission-control>3- More Permission Control</a></li><li><a href=#4--framework-integration>4- Framework Integration</a></li></ul></li><li><a href=#file-provider-implementation>File Provider Implementation</a><ul><li><a href=#how-content-providers-handle-files>How Content Providers Handle Files</a></li></ul></li><li><a href=#configuration--permissions>Configuration & Permissions</a><ul><li><a href=#manifest-declaration>Manifest Declaration</a></li><li><a href=#some-key-attributes>Some Key Attributes</a><ul><li><a href=#androidexported>android:exported</a></li><li><a href=#permission-levels>Permission Levels</a></li><li><a href=#temporary-uri-permissions>Temporary URI Permissions</a></li></ul></li></ul></li><li><a href=#data-types-and-mime-types>Data Types and MIME Types</a><ul><li><a href=#supported-data-types>Supported Data Types</a></li><li><a href=#mime-type-conventions>MIME Type Conventions</a></li></ul></li><li><a href=#common-vulnerabilities>Common Vulnerabilities</a><ul><li><a href=#1-overly-open-access-controls>1. Overly open Access Controls</a><ul><li><a href=#vulnerability>Vulnerability</a></li><li><a href=#vulnerable-code-example>Vulnerable Code Example</a></li><li><a href=#mitigation>Mitigation</a></li></ul></li><li><a href=#2-improperly-exposed-directories-to-fileprovider>2. Improperly Exposed Directories to FileProvider</a><ul><li><a href=#vulnerability-1>Vulnerability</a></li><li><a href=#attack>Attack</a></li><li><a href=#vulnerable-code-example-1>Vulnerable Code Example</a></li><li><a href=#mitigation-1>Mitigation</a></li></ul></li><li><a href=#3-path-traversal-when-using-data-from-uri>3. Path Traversal when using data from Uri</a><ul><li><a href=#vulnerability-2>Vulnerability</a></li><li><a href=#attack-1>Attack</a></li><li><a href=#vulnerable-code-example-2>Vulnerable Code Example</a></li><li><a href=#mitigation-2>Mitigation</a></li></ul></li><li><a href=#4-trusting-contentprovider-provided-filename>4. Trusting ContentProvider-Provided Filename</a><ul><li><a href=#vulnerability-3>Vulnerability</a></li><li><a href=#attack-2>Attack</a></li><li><a href=#vulnerable-code-example-3>Vulnerable Code Example</a></li><li><a href=#mitigation-3>Mitigation</a></li></ul></li><li><a href=#5-exploiting-implicit-intents-for-file-theft-and-overwriting>5. Exploiting Implicit Intents for File Theft and Overwriting</a><ul><li><a href=#vulnerability-4>Vulnerability</a></li><li><a href=#attack-for-file-theft>Attack for File Theft</a></li><li><a href=#attack-for-arbitrary-file-overwriting>Attack for Arbitrary File Overwriting</a></li><li><a href=#vulnerable-code-example-4>Vulnerable Code Example</a></li><li><a href=#mitigation-4>Mitigation</a></li></ul></li><li><a href=#6-proxying-requests-to-more-secure-providers>6. Proxying Requests to More Secure Providers</a><ul><li><a href=#vulnerability-5>Vulnerability</a></li><li><a href=#note-on-vulnerable-code-example>Note on Vulnerable Code Example</a></li><li><a href=#mitigation-5>Mitigation</a></li></ul></li><li><a href=#7-theft-of-arbitrary-files-via-file-choosers-in-webview>7. Theft of Arbitrary Files via File Choosers in WebView</a><ul><li><a href=#vulnerability-6>Vulnerability</a></li><li><a href=#attack-3>Attack</a></li><li><a href=#vulnerable-code-example-5>Vulnerable Code Example</a></li><li><a href=#mitigation-6>Mitigation</a></li></ul></li><li><a href=#8-gaining-access-via-intent-redirection-to-protected-components>8. Gaining Access via Intent Redirection to Protected Components</a><ul><li><a href=#vulnerability-7>Vulnerability</a></li><li><a href=#attack-4>Attack</a></li><li><a href=#vulnerable-code-example-6>Vulnerable Code Example</a></li><li><a href=#mitigation-7>Mitigation</a></li></ul></li><li><a href=#9-sql-injection-in-shared-databases>9. SQL Injection in Shared Databases</a><ul><li><a href=#vulnerability-8>Vulnerability</a></li><li><a href=#vulnerable-code-example-7>Vulnerable Code Example</a></li><li><a href=#mitigation-8>Mitigation</a></li></ul></li><li><a href=#10-zip-path-traversal-zipslip>10. Zip Path Traversal (ZipSlip)</a><ul><li><a href=#vulnerability-9>Vulnerability</a></li><li><a href=#attack-5>Attack</a></li><li><a href=#vulnerable-code-example-8>Vulnerable Code Example</a></li><li><a href=#mitigation-9>Mitigation</a></li></ul></li></ul></li><li><a href=#security--best-practices>Security & Best Practices</a><ul><li><a href=#permission-strategy>Permission Strategy</a><ul><li><a href=#restrict-access-through-permissions>Restrict Access Through Permissions</a></li></ul></li><li><a href=#secure-data-storage>Secure Data Storage</a></li><li><a href=#prevent-sql-injection>Prevent SQL Injection</a></li><li><a href=#implementation-best-practices>Implementation Best Practices</a><ul><li><a href=#thread-safety>Thread Safety</a></li><li><a href=#efficient-oncreate>Efficient onCreate()</a></li><li><a href=#contract-classes>Contract Classes</a></li></ul></li></ul></li><li><a href=#in-the-end>In The end</a></li><li><a href=#resources>Resources</a><ul><li><a href=#documentation>Documentation</a></li><li><a href=#security-resources>Security Resources</a></li><li><a href=#best-practices>Best Practices</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const n=.33,s="#TableOfContents",o=".anchor",i='a[href^="#"]',a="li ul",r="active";function c(e,t){const s=window.scrollY+window.innerHeight*t,o=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],n=new Set(o.map(e=>e.getAttribute("href").substring(1)));for(let t=e.length-1;t>=0;t--){const o=e[t].getBoundingClientRect().top+window.scrollY;if(o<=s&&n.has(e[t].id))return e[t].id}return e.find(e=>n.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=c(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(r,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function t(){const t=document.querySelector(s);if(!t)return;const c=!0,l=[...document.querySelectorAll(o)],d=[...t.querySelectorAll(i)];c&&t.querySelectorAll(a).forEach(e=>e.style.display="none");const r={toc:t,anchors:l,links:d,scrollOffset:n,collapseInactive:c};window.addEventListener("scroll",()=>e(r),{passive:!0}),window.addEventListener("hashchange",()=>e(r),{passive:!0}),e(r)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">Summary<div id=summary class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#summary aria-label=Anchor>#</a></span></h2><blockquote><p>A way to <strong>manage access to data</strong> and <strong>make sharing this data with other applications easier</strong>. Think of it like having notes saved in one app (A) that you want other apps (B,C,D etc&mldr;) to access - but they&rsquo;re saved locally so Android will deny access for any other app. OK Simple, just call the provider and it will provide it for us! 😄</p></blockquote><p>They are designed to <strong>manage access to data</strong> and <strong>Makes sharing this data with other applications easier</strong>. They encapsulate the data and act as an interface connecting data in one process with code running in another process, Each row represents an instance of data, and each column represents an individual piece of data for that instance</p><blockquote><p>[!INFO] Who can access Content Providers?</p><ol><li><strong>Your own app components</strong> - Activities, Services, Broadcast Receivers</li><li><strong>Other applications</strong> - If properly configured with permissions</li><li><strong>System apps</strong> - Android framework components like sync adapters</li><li><strong>Widgets</strong> - Home screen widgets that need app data</li><li><strong>Third-party apps</strong> - With appropriate permissions and export settings</li></ol></blockquote><h3 class="relative group">What is a File Provider?<div id=what-is-a-file-provider class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#what-is-a-file-provider aria-label=Anchor>#</a></span></h3><p>A &ldquo;file provider&rdquo; is not a separate Android component. Instead, It&rsquo;s a <strong>Content Provider that is specifically designed and configured to manage and share file-based data</strong>.</p><h2 class="relative group">What Content Providers Look Like<div id=what-content-providers-look-like class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#what-content-providers-look-like aria-label=Anchor>#</a></span></h2><h3 class="relative group">Core Components<div id=core-components class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#core-components aria-label=Anchor>#</a></span></h3><h4 class="relative group">1. Provider Client (ContentResolver)<div id=1-provider-client-contentresolver class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#1-provider-client-contentresolver aria-label=Anchor>#</a></span></h4><p><em>Accessing data from a content provider</em></p><p>When an application wants to access data in a content provider, it uses the <code>ContentResolver</code> object available in its <code>Context</code>. The <code>ContentResolver</code> communicates with the provider object, performs the requested action, and returns results.</p><p><strong>Basic CRUD Operations:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Get ContentResolver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ContentResolver</span><span class=w> </span><span class=n>resolver</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Query data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>resolver</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>uri</span><span class=p>,</span><span class=w>              </span><span class=c1>// Content URI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>projection</span><span class=p>,</span><span class=w>       </span><span class=c1>// Columns to return</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>selection</span><span class=p>,</span><span class=w>        </span><span class=c1>// WHERE clause</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w>    </span><span class=c1>// WHERE clause arguments</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sortOrder</span><span class=w>         </span><span class=c1>// Sort order</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Insert data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ContentValues</span><span class=w> </span><span class=n>values</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ContentValues</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>values</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;column_name&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;value&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Uri</span><span class=w> </span><span class=n>newUri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>resolver</span><span class=p>.</span><span class=na>insert</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>values</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Update data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>int</span><span class=w> </span><span class=n>rowsUpdated</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>resolver</span><span class=p>.</span><span class=na>update</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>values</span><span class=p>,</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Delete data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>int</span><span class=w> </span><span class=n>rowsDeleted</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>resolver</span><span class=p>.</span><span class=na>delete</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Bonus query code<div id=bonus-query-code class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#bonus-query-code aria-label=Anchor>#</a></span></h4><p>This will return all data that the uri can access in database</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>query</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://io.hextree.flag30/success&#34;</span><span class=p>),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// dump Uri</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=o>!=</span><span class=kc>null</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToFirst</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>do</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnCount</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sb</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&#34;, &#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>sb</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>getColumnName</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34; = &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>cursor</span><span class=p>.</span><span class=na>getString</span><span class=p>(</span><span class=n>i</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>d</span><span class=p>(</span><span class=s>&#34;evil&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cursor</span><span class=p>.</span><span class=na>moveToNext</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">2. Provider (ContentProvider subclass)<div id=2-provider-contentprovider-subclass class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#2-provider-contentprovider-subclass aria-label=Anchor>#</a></span></h4><p><em>The actual implementation that manages access to data</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyContentProvider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Initialize provider (keep it fast!)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>sortOrder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Return data based on query</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>cursor</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Uri</span><span class=w> </span><span class=nf>insert</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>ContentValues</span><span class=w> </span><span class=n>values</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Insert new data and return URI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>newUri</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>ContentValues</span><span class=w> </span><span class=n>values</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Update existing data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>rowsAffected</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>delete</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Delete data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>rowsDeleted</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getType</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Return MIME type for the URI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>mimeType</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 class="relative group">Built-in Content Providers<div id=built-in-content-providers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#built-in-content-providers aria-label=Anchor>#</a></span></h2><p>Android includes many system content providers including :</p><ul><li><strong>User Dictionary Provider</strong>: Non-standard words for spellcheck</li><li><strong>Contacts Provider</strong>: User contact information</li><li><strong>MediaStore</strong>: Images, videos, audio files on device</li><li><strong>Calendar Provider</strong>: Calendar events and data</li></ul><h2 class="relative group">Creating Custom Content Providers<div id=creating-custom-content-providers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#creating-custom-content-providers aria-label=Anchor>#</a></span></h2><h3 class="relative group">1. Design Data Storage<div id=1-design-data-storage class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#1-design-data-storage aria-label=Anchor>#</a></span></h3><p><strong>For structured data:</strong></p><ul><li>Decide storage mechanism (SQLite, files, etc.)</li><li>Data must have primary key column (often <code>BaseColumns._ID</code>)</li></ul><p><strong>For file data (unstructured):</strong></p><ul><li>Use file-oriented APIs</li><li>You can mix and match different storage types and expose them through a single content provider</li></ul><h3 class="relative group">Example of a DB that is prover can query<div id=example-of-a-db-that-is-prover-can-query class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#example-of-a-db-that-is-prover-can-query aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>FlagDatabaseHelper</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>SQLiteOpenHelper</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_CONTENT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;content&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;_id&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;name&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_TITLE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;title&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_VALUE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;value&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_VISIBLE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;visible&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>CREATE_TABKE_NOTE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;CREATE TABLE Note (_id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT NOT NULL, content TEXT NOT NULL );&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>CREATE_TABLE_FLAG</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;CREATE TABLE Flag (_id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, value TEXT NOT NULL, visible INTEGER NOT NULL DEFAULT 1);&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>DATABASE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;flag.db&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>DATABASE_VERSION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>TABLE_FLAG</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Flag&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>TABLE_NOTE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Note&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>FlagDatabaseHelper</span><span class=p>(</span><span class=n>Context</span><span class=w> </span><span class=n>context</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>(</span><span class=n>context</span><span class=p>,</span><span class=w> </span><span class=n>DATABASE_NAME</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>SQLiteDatabase</span><span class=p>.</span><span class=na>CursorFactory</span><span class=p>)</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.database.sqlite.SQLiteOpenHelper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>sQLiteDatabase</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Log</span><span class=p>.</span><span class=na>i</span><span class=p>(</span><span class=s>&#34;FlagDatabaseHelper&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;database created&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=n>CREATE_TABLE_FLAG</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=n>CREATE_TABKE_NOTE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Flag (name, value, visible) VALUES (&#39;flag30&#39;, &#39;HXT{censored}&#39;, 1);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Flag (name, value, visible) VALUES (&#39;flag31&#39;, &#39;HXT{censored}&#39;, 1);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Flag (name, value, visible) VALUES (&#39;flag32&#39;, &#39;HXT{censored}&#39;, 0);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Note (title, content) VALUES (&#39;secret&#39;, &#39;This is a secret note&#39;);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;INSERT INTO Note (title, content) VALUES (&#39;flag33&#39;, &#39;HXT{censored}&#39;);&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.database.sqlite.SQLiteOpenHelper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onUpgrade</span><span class=p>(</span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>sQLiteDatabase</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i2</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sQLiteDatabase</span><span class=p>.</span><span class=na>execSQL</span><span class=p>(</span><span class=s>&#34;DROP TABLE IF EXISTS Flag&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>onCreate</span><span class=p>(</span><span class=n>sQLiteDatabase</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>From here we can see names an columns and how many table we have</p><h4 class="relative group"><strong>Database Structure</strong><div id=database-structure class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#database-structure aria-label=Anchor>#</a></span></h4><ol><li><p><strong>Database Name</strong>: <code>flag.db</code></p></li><li><p><strong>Tables</strong>:</p><ul><li><p><code>Flag</code> - Stores flag information</p></li><li><p><code>Note</code> - Stores notes (potentially containing additional flags)</p></li></ul></li></ol><h4 class="relative group"><strong>Flag Table Schema</strong><div id=flag-table-schema class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-table-schema aria-label=Anchor>#</a></span></h4><table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_id</code></td><td>INTEGER (PK)</td><td>Auto-incrementing ID</td></tr><tr><td><code>name</code></td><td>TEXT</td><td>Flag name (e.g., <code>flag30</code>, <code>flag31</code>)</td></tr><tr><td><code>value</code></td><td>TEXT</td><td>Flag value (e.g., <code>HXT{censored}</code>)</td></tr><tr><td><code>visible</code></td><td>INTEGER</td><td>Visibility flag (<code>1</code> = visible, <code>0</code> = hidden)</td></tr></tbody></table><h4 class="relative group"><strong>Note Table Schema</strong><div id=note-table-schema class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#note-table-schema aria-label=Anchor>#</a></span></h4><table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_id</code></td><td>INTEGER (PK)</td><td>Auto-incrementing ID</td></tr><tr><td><code>title</code></td><td>TEXT</td><td>Note title</td></tr><tr><td><code>content</code></td><td>TEXT</td><td>Note content</td></tr></tbody></table><h4 class="relative group"><strong>Flag Table (Initial Entries)</strong><div id=flag-table-initial-entries class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag-table-initial-entries aria-label=Anchor>#</a></span></h4><table><thead><tr><th><code>name</code></th><th><code>value</code></th><th><code>visible</code></th></tr></thead><tbody><tr><td><code>flag30</code></td><td><code>HXT{censored}</code></td><td><code>1</code> (visible)</td></tr><tr><td><code>flag31</code></td><td><code>HXT{censored}</code></td><td><code>1</code> (visible)</td></tr><tr><td><code>flag32</code></td><td><code>HXT{censored}</code></td><td><code>0</code> (hidden)</td></tr></tbody></table><h4 class="relative group"><strong>Note Table (Initial Entries)</strong><div id=note-table-initial-entries class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#note-table-initial-entries aria-label=Anchor>#</a></span></h4><table><thead><tr><th><code>title</code></th><th><code>content</code></th></tr></thead><tbody><tr><td><code>secret</code></td><td><code>This is a secret note</code></td></tr><tr><td><code>flag33</code></td><td><code>HXT{censored}</code></td></tr></tbody></table><h3 class="relative group">2. Implement ContentProvider<div id=2-implement-contentprovider class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#2-implement-contentprovider aria-label=Anchor>#</a></span></h3><p>Create subclass implementing six abstract methods:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>CustomProvider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Must be thread-safe (except onCreate)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Fast initialization only - defer heavy tasks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Implement CRUD operations...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// (See code examples above)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">3. Define Metadata<div id=3-define-metadata class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#3-define-metadata aria-label=Anchor>#</a></span></h3><p>Create a <strong>contract class</strong> with constants:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>class</span> <span class=nc>ProviderContract</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>AUTHORITY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;com.example.provider&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Uri</span><span class=w> </span><span class=n>BASE_URI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>AUTHORITY</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>class</span> <span class=nc>TableName</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Uri</span><span class=w> </span><span class=n>URI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>withAppendedPath</span><span class=p>(</span><span class=n>BASE_URI</span><span class=p>,</span><span class=w> </span><span class=s>&#34;table&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_ID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;_id&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;name&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li><strong>Authority (<code>android:authorities</code>):</strong> This is the symbolic name that uniquely identifies your provider within the system. Use reverse internet domain ownership (e.g., <code>com.example.yourapp.provider</code>) to avoid conflicts</li><li><strong>Content URIs:</strong> URIs identify data in your provider. They combine the <code>content://</code> scheme, the provider&rsquo;s authority, and a path that points to a table or file (e.g., <code>content://user_dictionary/words</code>)</li><li><strong>Handling Content URI IDs:</strong> By convention, content URIs can include an ID value appended to the path (e.g., <code>content://user_dictionary/words/4</code>) to refer to a single row. The <code>UriMatcher</code> class can be used to map URI patterns (using wildcards like <code>*</code> for any string and <code>#</code> for any numeric string) to integer values, allowing you to easily handle different types of URI requests in a <code>switch</code> statement</li></ul><h3 class="relative group">4. Manifest Registration<div id=4-manifest-registration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#4-manifest-registration aria-label=Anchor>#</a></span></h3><p>Register in <code>AndroidManifest.xml</code> with proper authorities and permissions.</p><h2 class="relative group">Use Cases<div id=use-cases class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#use-cases aria-label=Anchor>#</a></span></h2><h3 class="relative group">1- Secure Data Sharing<div id=1--secure-data-sharing class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#1--secure-data-sharing aria-label=Anchor>#</a></span></h3><p>They allow other applications to securely access and modify your app&rsquo;s data with proper permission controls.</p><h3 class="relative group">2- Data Abstraction<div id=2--data-abstraction class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#2--data-abstraction aria-label=Anchor>#</a></span></h3><p>Content providers abstract away the details of underlying data storage. You can change your internal data storage implementation (e.g., from SQLite to files) without affecting other applications.</p><h3 class="relative group">3- More Permission Control<div id=3--more-permission-control class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#3--more-permission-control aria-label=Anchor>#</a></span></h3><p>Greater control over permissions for accessing data:</p><ul><li>Restrict access to only your application</li><li>Grant blanket permission to other applications</li><li>Configure different permissions for reading vs writing data</li></ul><h3 class="relative group">4- Framework Integration<div id=4--framework-integration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#4--framework-integration aria-label=Anchor>#</a></span></h3><p>Several Android classes rely on <code>ContentProvider</code>:</p><ul><li><code>AbstractThreadedSyncAdapter</code> for server synchronization</li><li><code>CursorAdapter</code> and <code>CursorLoader</code> for async UI data loading</li><li>Custom search suggestions implementation</li><li>Widget data exposure</li><li>Complex data copy/paste operations</li></ul><h2 class="relative group">File Provider Implementation<div id=file-provider-implementation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#file-provider-implementation aria-label=Anchor>#</a></span></h2><h3 class="relative group">How Content Providers Handle Files<div id=how-content-providers-handle-files class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#how-content-providers-handle-files aria-label=Anchor>#</a></span></h3><p>When a content provider is used to share files, it manages file data such as photos, audio, or videos. Rather than storing large file data directly in a table, it is recommended to <strong>store the data in a file</strong> (preferably in your application&rsquo;s private space) and then <strong>provide indirect access or a handle to that file</strong> when requested by another application.</p><p>For content providers that offer files, you are expected to implement the <code>getStreamTypes()</code> method, which returns a string array of MIME types (e.g., &ldquo;image/jpeg&rdquo;, &ldquo;image/png&rdquo;) for the files your provider can return for a given content URI.</p><blockquote><p>[!WARNING] External Storage Security If files are stored on <strong>external storage</strong>, they are typically <strong>public and world-readable by default</strong>, and a content provider <strong>cannot restrict access</strong> to them through its own permissions, as other applications can use different API calls to read and write them directly. To ensure control over access to your data, you should store it in internal files, SQLite databases, or cloud storage, and keep these private to your application.</p></blockquote><h2 class="relative group">Configuration & Permissions<div id=configuration--permissions class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#configuration--permissions aria-label=Anchor>#</a></span></h2><h3 class="relative group">Manifest Declaration<div id=manifest-declaration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#manifest-declaration aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.MyContentProvider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;com.example.provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:permission=</span><span class=s>&#34;com.example.READ_WRITE_PERMISSION&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:readPermission=</span><span class=s>&#34;com.example.READ_PERMISSION&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:writePermission=</span><span class=s>&#34;com.example.WRITE_PERMISSION&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:grantUriPermissions=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Path-specific permissions --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;path-permission</span> 
</span></span><span class=line><span class=cl>        <span class=na>android:path=</span><span class=s>&#34;/sensitive/*&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:readPermission=</span><span class=s>&#34;com.example.SENSITIVE_READ&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Temporary URI permissions --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;grant-uri-permission</span> <span class=na>android:pathPattern=</span><span class=s>&#34;/temp/*&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/provider&gt;</span>
</span></span></code></pre></div><h3 class="relative group">Some Key Attributes<div id=some-key-attributes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#some-key-attributes aria-label=Anchor>#</a></span></h3><h4 class="relative group">android:exported<div id=androidexported class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#androidexported aria-label=Anchor>#</a></span></h4><ul><li><strong>Default behavior changed in API 17</strong>: Defaults to <code>false</code> if no intent filters</li><li>If intent filters are defined, defaults to <code>true</code> unless explicitly set to <code>false</code></li><li>External calls are blocked by activity manager if not exported (unless calling process is root/system)</li></ul><h4 class="relative group">Permission Levels<div id=permission-levels class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#permission-levels aria-label=Anchor>#</a></span></h4><ol><li><strong>Provider-level</strong>:<ul><li><code>android:permission</code> (single read/write)</li><li><code>android:readPermission</code> / <code>android:writePermission</code> (separate permissions)</li><li>Separate permissions take precedence over single permission</li></ul></li><li><strong>Path-level</strong>:<ul><li><code>&lt;path-permission></code> child elements</li><li>Apply to specific content URI paths</li><li>Take precedence over provider-level permissions</li></ul></li></ol><h4 class="relative group">Temporary URI Permissions<div id=temporary-uri-permissions class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#temporary-uri-permissions aria-label=Anchor>#</a></span></h4><ul><li>These grant temporary access to a specific content URI, reducing the need for an app to request permanent permissions in its manifest.</li><li>Enabled by <code>android:grantUriPermissions="true"</code> or <code>&lt;grant-uri-permission></code></li><li>Granted via setting intent flags to: <code>FLAG_GRANT_READ_URI_PERMISSION</code> or <code>FLAG_GRANT_WRITE_URI_PERMISSION</code> when sending the content URI to another application.</li><li>Automatically revoked when receiving activity finishes</li></ul><h2 class="relative group">Data Types and MIME Types<div id=data-types-and-mime-types class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#data-types-and-mime-types aria-label=Anchor>#</a></span></h2><h3 class="relative group">Supported Data Types<div id=supported-data-types class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#supported-data-types aria-label=Anchor>#</a></span></h3><p>Content providers can manage various data storage sources:</p><ul><li><strong>Structured data</strong> (like a SQLite relational database)</li><li><strong>Unstructured data</strong> such as <strong>image files, audio, or video media</strong></li><li><strong>Binary Large Objects (BLOBs)</strong> - implemented as byte arrays</li><li>For file-oriented data (images/videos), store in files and provide indirect access</li></ul><h3 class="relative group">MIME Type Conventions<div id=mime-type-conventions class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mime-type-conventions aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Standard MIME types for common data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s>&#34;text/html&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s>&#34;image/jpeg&#34;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Android vendor-specific MIME types for table data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Multiple rows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s>&#34;vnd.android.cursor.dir/vnd.com.example.provider.table1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Single row  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s>&#34;vnd.android.cursor.item/vnd.example.line2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Get MIME type programmatically</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>mimeType</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>getType</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h2 class="relative group">Common Vulnerabilities<div id=common-vulnerabilities class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#common-vulnerabilities aria-label=Anchor>#</a></span></h2><h3 class="relative group">1. Overly open Access Controls<div id=1-overly-open-access-controls class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#1-overly-open-access-controls aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability aria-label=Anchor>#</a></span></h4><ul><li><strong>Default exported state</strong>: Historically public by default (changed in API 17)</li><li><strong>Missing permissions</strong>: No read/write permissions set</li><li><strong>Inadequate permissions</strong>: Generic permissions for sensitive data</li></ul><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>// Manifest: AndroidManifest.xml
</span></span><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.MyContentProvider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;com.example.myapp.provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>*/
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyContentProvider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>DatabaseHelper</span><span class=w> </span><span class=n>dbHelper</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>dbHelper</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DatabaseHelper</span><span class=p>(</span><span class=n>getContext</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>sortOrder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Vulnerable: No permission checks, exposes sensitive data to any app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>db</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dbHelper</span><span class=p>.</span><span class=na>getReadableDatabase</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>db</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=s>&#34;sensitive_table&#34;</span><span class=p>,</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>sortOrder</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Other required methods (insert, update, delete, getType) omitted for brevity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- Explicitly set exported and permissions --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.MyProvider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;com.example.provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:permission=</span><span class=s>&#34;com.example.permission.SIGNATURE_REQUIRED&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Use signature-level protection for sensitive data --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;permission</span> 
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;com.example.permission.SIGNATURE_REQUIRED&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:protectionLevel=</span><span class=s>&#34;signature&#34;</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><h3 class="relative group">2. Improperly Exposed Directories to FileProvider<div id=2-improperly-exposed-directories-to-fileprovider class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#2-improperly-exposed-directories-to-fileprovider aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-1 aria-label=Anchor>#</a></span></h4><p>An improperly configured <code>FileProvider</code> can expose files and directories to an attacker. This often occurs when the <code>FileProvider</code> configuration uses broad path elements, such as <code>&lt;root-path></code>, which corresponds to the device&rsquo;s root directory (<code>/</code>), or shares a wide path range like <code>.</code> or <code>/</code>.</p><ul><li>Using <code>root-path</code> allowing arbitrary file access</li><li>Sharing entire private directories (<code>files</code>, <code>cache</code>)</li><li>General-purpose providers instead of specific ones</li></ul><h4 class="relative group">Attack<div id=attack class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack aria-label=Anchor>#</a></span></h4><p>Allowing <code>&lt;root-path></code> grants arbitrary access to files and folders, including an app&rsquo;s sandbox and <code>/sdcard</code> directory, presenting a broad attack surface. This can enable an attacker to access sensitive information stored in databases or overwrite the application&rsquo;s native libraries, potentially leading to arbitrary code execution.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-1 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>// res/xml/file_paths.xml:
</span></span><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl><span class=nt>&lt;paths&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;root-path</span> <span class=na>name=</span><span class=s>&#34;root&#34;</span> <span class=na>path=</span><span class=s>&#34;&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/paths&gt;</span>
</span></span><span class=line><span class=cl>*/
</span></span><span class=line><span class=cl>// Manifest: AndroidManifest.xml
</span></span><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;androidx.core.content.FileProvider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;com.example.myapp.fileprovider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:grantUriPermissions=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;meta-data</span>
</span></span><span class=line><span class=cl>        <span class=na>android:name=</span><span class=s>&#34;android.support.FILE_PROVIDER_PATHS&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:resource=</span><span class=s>&#34;@xml/file_paths&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/provider&gt;</span>
</span></span><span class=line><span class=cl>*/
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>FileShareActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>File</span><span class=w> </span><span class=n>file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=s>&#34;/path/to/file&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Vulnerable: Broad path exposes entire filesystem</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FileProvider</span><span class=p>.</span><span class=na>getUriForFile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span><span class=w> </span><span class=s>&#34;com.example.myapp.fileprovider&#34;</span><span class=p>,</span><span class=w> </span><span class=n>file</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Intent</span><span class=w> </span><span class=n>shareIntent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>(</span><span class=n>Intent</span><span class=p>.</span><span class=na>ACTION_SEND</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>shareIntent</span><span class=p>.</span><span class=na>setData</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>shareIntent</span><span class=p>.</span><span class=na>addFlags</span><span class=p>(</span><span class=n>Intent</span><span class=p>.</span><span class=na>FLAG_GRANT_READ_URI_PERMISSION</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>startActivity</span><span class=p>(</span><span class=n>shareIntent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-1 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- file_paths.xml - SECURE configuration --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;paths</span> <span class=na>xmlns:android=</span><span class=s>&#34;http://schemas.android.com/apk/res/android&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Specific subdirectory only --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;cache-path</span> <span class=na>name=</span><span class=s>&#34;shared_images&#34;</span> <span class=na>path=</span><span class=s>&#34;images/&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- NOT entire cache: &lt;cache-path name=&#34;cache&#34; path=&#34;.&#34; /&gt; --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/paths&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Manifest --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;androidx.core.content.FileProvider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;${applicationId}.fileprovider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:grantUriPermissions=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;meta-data</span>
</span></span><span class=line><span class=cl>        <span class=na>android:name=</span><span class=s>&#34;android.support.FILE_PROVIDER_PATHS&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:resource=</span><span class=s>&#34;@xml/file_paths&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/provider&gt;</span>
</span></span></code></pre></div><p><strong>Additional Mitigations:</strong></p><ul><li><strong>Do not use the <code>&lt;root-path></code> path element</strong>: This element grants arbitrary access to the entire device&rsquo;s root directory</li><li><strong>Share narrow path ranges</strong>: Instead of broad path ranges like <code>.</code> or <code>/</code>, specify limited and narrow paths in the <code>FileProvider</code> configuration</li><li><strong>Grant minimum access permissions</strong>: When granting content URI permissions, ensure only the minimum necessary access is given</li><li><strong>Avoid <code>&lt;external-path></code> for sensitive data</strong>: Sensitive data should not be stored in external storage accessible via <code>&lt;external-path></code></li></ul><h3 class="relative group">3. Path Traversal when using data from Uri<div id=3-path-traversal-when-using-data-from-uri class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#3-path-traversal-when-using-data-from-uri aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-2 aria-label=Anchor>#</a></span></h4><p>This common mistake occurs when developers use data from <code>Uri</code> methods like <code>Uri.getLastPathSegment()</code> or <code>Uri.getPathSegments()</code> without proper validation before passing it to file system APIs. These methods decode URL-encoded values, which attackers can exploit.</p><ul><li>Using <code>Uri.getLastPathSegment()</code> without validation</li><li>URL-decoded values allowing <code>..%2F</code> injection</li><li>Trusting ContentProvider-provided filenames</li></ul><h4 class="relative group">Attack<div id=attack-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-1 aria-label=Anchor>#</a></span></h4><p>An attacker can provide a URL-encoded path traversal sequence (e.g., <code>%2F</code> for <code>/</code>) within a URI. When the vulnerable app decodes and uses this URI segment, it can be tricked into accessing or modifying files outside the intended directory. For example, an attacker could craft a URI like <code>content://com.victim.path_traversal/..%2Fshared_prefs%2Fsecrets.xml</code> to retrieve the contents of the <code>secrets.xml</code> file, which is typically stored in a private directory.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-2 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>FileAccessActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>().</span><span class=na>getData</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>uri</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// Vulnerable: No validation of fileName allows path traversal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>fileName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uri</span><span class=p>.</span><span class=na>getLastPathSegment</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>File</span><span class=w> </span><span class=n>file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=n>fileName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>file</span><span class=p>.</span><span class=na>exists</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>FileInputStream</span><span class=w> </span><span class=n>fis</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FileInputStream</span><span class=p>(</span><span class=n>file</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// Process file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>FileNotFoundException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-2 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// SECURE: Validate file paths</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>File</span><span class=w> </span><span class=nf>getSecureFile</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>filename</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uri</span><span class=p>.</span><span class=na>getLastPathSegment</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>filename</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Re-encode to prevent path traversal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>filename</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>encode</span><span class=p>(</span><span class=n>filename</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>File</span><span class=w> </span><span class=n>file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getSecureDirectory</span><span class=p>(),</span><span class=w> </span><span class=n>filename</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Validate canonical path is within expected directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>canonicalPath</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>file</span><span class=p>.</span><span class=na>getCanonicalPath</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>secureDir</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getSecureDirectory</span><span class=p>().</span><span class=na>getCanonicalPath</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>canonicalPath</span><span class=p>.</span><span class=na>startsWith</span><span class=p>(</span><span class=n>secureDir</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SecurityException</span><span class=p>(</span><span class=s>&#34;Path traversal attempt detected&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>file</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Generate unique filenames instead of trusting input</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>generateUniqueFilename</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>extension</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;.&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>extension</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>Additional Mitigations:</strong></p><ul><li><strong>Validate the resulting path</strong>: Canonicalize the path using <code>File.getCanonicalPath()</code> and compare its prefix with the expected safe directory</li><li><strong>Implement additional validation</strong>: Include checks to prevent accidental overwrites and confirm operations occur in the expected directory</li><li><strong>Avoid sharing broad folders in Content Providers</strong>: Ensure Content Providers do not expose &ldquo;broad&rdquo; folders like <code>files</code> or <code>cache</code></li></ul><h3 class="relative group">4. Trusting ContentProvider-Provided Filename<div id=4-trusting-contentprovider-provided-filename class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#4-trusting-contentprovider-provided-filename aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-3 aria-label=Anchor>#</a></span></h4><p>If a client application doesn&rsquo;t correctly handle a filename provided by a <code>FileProvider</code>, a malicious application can implement its own <code>FileProvider</code> to provide a crafted filename.</p><h4 class="relative group">Attack<div id=attack-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-2 aria-label=Anchor>#</a></span></h4><p>A malicious <code>FileProvider</code> can supply a filename that includes path traversal characters (e.g., <code>../</code>). When the victim client application attempts to write the received file to its storage using this untrusted filename, it might overwrite its own critical files, such as application code, shared preferences, or other configuration files, potentially leading to malicious code execution or altered application behavior.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-3 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>FileWriteActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>().</span><span class=na>getData</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>uri</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// Vulnerable: Uses untrusted filename directly</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>fileName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uri</span><span class=p>.</span><span class=na>getLastPathSegment</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>File</span><span class=w> </span><span class=n>outputFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>getFilesDir</span><span class=p>(),</span><span class=w> </span><span class=n>fileName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>OutputStream</span><span class=w> </span><span class=n>os</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FileOutputStream</span><span class=p>(</span><span class=n>outputFile</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// Write data to outputFile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>FileNotFoundException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-3 aria-label=Anchor>#</a></span></h4><ul><li><strong>Don&rsquo;t trust user input for filenames</strong>: When a client application writes a received file, it should ignore the filename provided by the &ldquo;server&rdquo; application and instead generate its own unique filename</li><li><strong>Sanitize provided filenames (less desirable)</strong>: If unique filenames cannot be generated, sanitize the provided filename by removing path traversal characters and performing canonicalization</li></ul><h3 class="relative group">5. Exploiting Implicit Intents for File Theft and Overwriting<div id=5-exploiting-implicit-intents-for-file-theft-and-overwriting class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#5-exploiting-implicit-intents-for-file-theft-and-overwriting aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-4 aria-label=Anchor>#</a></span></h4><p>Applications often launch implicit intents (e.g., <code>ACTION_PICK</code>, <code>GET_CONTENT</code>, <code>IMAGE_CAPTURE</code>) to interact with other apps, such as file managers or camera apps, to obtain a URI to a file. If the vulnerable app then copies the content from this URI to its public storage or processes it insecurely, it can be exploited.</p><h4 class="relative group">Attack for File Theft<div id=attack-for-file-theft class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-for-file-theft aria-label=Anchor>#</a></span></h4><p>A malicious app can register an <code>intent-filter</code> with a high priority (<code>android:priority="999"</code>) to intercept these implicit intents. Instead of providing a legitimate file, the malicious app returns a <code>file://</code> URI that points to a sensitive file within the victim app&rsquo;s private directory. When the victim app receives this malicious URI and attempts to copy its content, it unknowingly copies its own private data to a public directory, which the attacker can then read.</p><h4 class="relative group">Attack for Arbitrary File Overwriting<div id=attack-for-arbitrary-file-overwriting class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-for-arbitrary-file-overwriting aria-label=Anchor>#</a></span></h4><p>Similarly, an attacker can use a malicious <code>ContentProvider</code> to return a filename that contains path traversal. If the vulnerable app copies the content using this filename, it could write arbitrary data to a sensitive location, like a native library file (<code>.so</code>), which could lead to arbitrary code execution within the victim app&rsquo;s context.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-4 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>FilePickerActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>REQUEST_CODE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Intent</span><span class=p>(</span><span class=n>Intent</span><span class=p>.</span><span class=na>ACTION_GET_CONTENT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>intent</span><span class=p>.</span><span class=na>setType</span><span class=p>(</span><span class=s>&#34;*/*&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>startActivityForResult</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span><span class=w> </span><span class=n>REQUEST_CODE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onActivityResult</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>requestCode</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>resultCode</span><span class=p>,</span><span class=w> </span><span class=n>Intent</span><span class=w> </span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onActivityResult</span><span class=p>(</span><span class=n>requestCode</span><span class=p>,</span><span class=w> </span><span class=n>resultCode</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>requestCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>REQUEST_CODE</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>resultCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>RESULT_OK</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// Vulnerable: No validation of URI source</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>File</span><span class=w> </span><span class=n>publicFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>Environment</span><span class=p>.</span><span class=na>getExternalStorageDirectory</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;public_file&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>InputStream</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getContentResolver</span><span class=p>().</span><span class=na>openInputStream</span><span class=p>(</span><span class=n>uri</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>OutputStream</span><span class=w> </span><span class=n>os</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FileOutputStream</span><span class=p>(</span><span class=n>publicFile</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>byte</span><span class=o>[</span><span class=n>1024</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=kt>int</span><span class=w> </span><span class=n>len</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>is</span><span class=p>.</span><span class=na>read</span><span class=p>(</span><span class=n>buffer</span><span class=p>))</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>os</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>,</span><span class=w> </span><span class=n>len</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>is</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>os</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-4 aria-label=Anchor>#</a></span></h4><ul><li><strong>Use internal storage for sensitive data</strong>: Always store sensitive application data in internal storage, which is restricted to the owning application</li><li><strong>Avoid public file storage</strong>: Do not use public file storage for caching or any other operations with sensitive data</li><li><strong>Encrypt sensitive data</strong>: If sensitive data must be stored on external storage, it should be encrypted using a strong algorithm</li><li><strong>Perform integrity checks</strong>: For data or code loaded from external storage, implement integrity checks using hashes</li><li><strong>Make intents explicit</strong>: Unless absolutely required, use explicit intents by calling <code>setPackage()</code></li><li><strong>Omit sensitive information from implicit intents</strong>: Do not include sensitive information or mutable objects</li><li><strong>Validate external URIs</strong>: Check URIs from <code>file://</code> or <code>content://</code> schemes to ensure they do not point to local private files</li></ul><h3 class="relative group">6. Proxying Requests to More Secure Providers<div id=6-proxying-requests-to-more-secure-providers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#6-proxying-requests-to-more-secure-providers aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-5 aria-label=Anchor>#</a></span></h4><ul><li>Lower-permission provider proxying to higher-permission provider</li><li>Dynamic URIs allowing attacker control over target provider</li></ul><h4 class="relative group">Note on Vulnerable Code Example<div id=note-on-vulnerable-code-example class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#note-on-vulnerable-code-example aria-label=Anchor>#</a></span></h4><p>The vulnerable code example for this vulnerability is complex and typically involves multiple ContentProviders. It involves a less secure provider forwarding requests to a secure one without proper authorization.</p><h4 class="relative group">Mitigation<div id=mitigation-5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-5 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// SECURE: Validate incoming URIs with allowlist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>ALLOWED_AUTHORITIES</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Set</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;com.example.safe.provider1&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;com.example.safe.provider2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>isUriSafe</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>authority</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uri</span><span class=p>.</span><span class=na>getAuthority</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>ALLOWED_AUTHORITIES</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=n>authority</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                   </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>sortOrder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>isUriSafe</span><span class=p>(</span><span class=n>uri</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SecurityException</span><span class=p>(</span><span class=s>&#34;Unauthorized provider access attempt&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Safe to proceed...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">7. Theft of Arbitrary Files via File Choosers in WebView<div id=7-theft-of-arbitrary-files-via-file-choosers-in-webview class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#7-theft-of-arbitrary-files-via-file-choosers-in-webview aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-6 aria-label=Anchor>#</a></span></h4><p>If an app implements <code>WebChromeClient.onShowFileChooser()</code> to allow users to select files from their device, but without proper validation of the chosen file&rsquo;s URI, it can be vulnerable.</p><h4 class="relative group">Attack<div id=attack-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-3 aria-label=Anchor>#</a></span></h4><p>An attacker can provide a specially crafted URL to the WebView that includes an <code>&lt;input type="file"></code> element. The attacker&rsquo;s app can then intercept the implicit intent launched by <code>onShowFileChooser()</code> and return the URI of a protected file from the victim&rsquo;s private storage. The WebView then receives this URI and can potentially leak the content of the protected file.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-5 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>WebViewActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>REQUEST_CODE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>ValueCallback</span><span class=o>&lt;</span><span class=n>Uri</span><span class=o>[]&gt;</span><span class=w> </span><span class=n>filePathCallback</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>WebView</span><span class=w> </span><span class=n>webView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebView</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>setContentView</span><span class=p>(</span><span class=n>webView</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>webView</span><span class=p>.</span><span class=na>setWebChromeClient</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>WebChromeClient</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onShowFileChooser</span><span class=p>(</span><span class=n>WebView</span><span class=w> </span><span class=n>webView</span><span class=p>,</span><span class=w> </span><span class=n>ValueCallback</span><span class=o>&lt;</span><span class=n>Uri</span><span class=o>[]&gt;</span><span class=w> </span><span class=n>filePathCallback</span><span class=p>,</span><span class=w> </span><span class=n>FileChooserParams</span><span class=w> </span><span class=n>fileChooserParams</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// Vulnerable: No validation of chosen file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>WebViewActivity</span><span class=p>.</span><span class=na>this</span><span class=p>.</span><span class=na>filePathCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>filePathCallback</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fileChooserParams</span><span class=p>.</span><span class=na>createIntent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>startActivityForResult</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span><span class=w> </span><span class=n>REQUEST_CODE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onActivityResult</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>requestCode</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>resultCode</span><span class=p>,</span><span class=w> </span><span class=n>Intent</span><span class=w> </span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onActivityResult</span><span class=p>(</span><span class=n>requestCode</span><span class=p>,</span><span class=w> </span><span class=n>resultCode</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>requestCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>REQUEST_CODE</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>resultCode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>RESULT_OK</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Uri</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>getData</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>filePathCallback</span><span class=p>.</span><span class=na>onReceiveValue</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Uri</span><span class=o>[]</span><span class=p>{</span><span class=n>result</span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-6 aria-label=Anchor>#</a></span></h4><ul><li><strong>Disable file access in WebSettings</strong>: Set <code>WebSettings.setAllowFileAccess(false)</code>, <code>WebSettings.setAllowFileAccessFromFileURLs(false)</code>, and <code>WebSettings.setAllowUniversalAccessFromFileURLs(false)</code></li><li><strong>Disable content access in WebSettings</strong>: Call <code>WebSettings.setAllowContentAccess(false)</code></li><li><strong>Use WebViewAssetLoader</strong>: This method provides a secure way to access local files via an <code>http(s)://</code> scheme</li><li><strong>Validate all URLs and origins</strong>: When loading external links in WebView, rigorously validate both the scheme and host</li><li><strong>Sanitize JavaScript with external data</strong>: Ensure any externally obtained data used with JavaScript has been properly sanitized</li><li><strong>Prevent WebView from loading untrusted content</strong>: If JavaScript execution and file access are enabled, strictly limit content loaded to trusted URLs</li></ul><h3 class="relative group">8. Gaining Access via Intent Redirection to Protected Components<div id=8-gaining-access-via-intent-redirection-to-protected-components class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#8-gaining-access-via-intent-redirection-to-protected-components aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-7 aria-label=Anchor>#</a></span></h4><p>An app with an exported activity that takes an <code>Intent</code> from outside and returns it via <code>Activity.setResult()</code> without filtering unsafe flags, can be forced to grant permissions to Content Providers with the <code>android:grantUriPermissions="true"</code> flag.</p><h4 class="relative group">Attack<div id=attack-4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-4 aria-label=Anchor>#</a></span></h4><p>An attacker sends an intent to this vulnerable activity. This intent includes a <code>data</code> URI pointing to the target <code>ContentProvider</code> and sets flags like <code>Intent.FLAG_GRANT_READ_URI_PERMISSION</code>. Because the vulnerable activity automatically returns the received intent (with its flags) via <code>setResult()</code>, the attacker&rsquo;s app receives this modified intent back, now possessing the granted read permission for the specified URI. This allows the attacker to steal or rewrite protected or arbitrary files belonging to the victim application.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-6 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>VulnerableActivity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Vulnerable: Returns intent without filtering flags</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Intent</span><span class=w> </span><span class=n>intent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getIntent</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>setResult</span><span class=p>(</span><span class=n>RESULT_OK</span><span class=p>,</span><span class=w> </span><span class=n>intent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>finish</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-7 aria-label=Anchor>#</a></span></h4><ul><li><strong>Never redirect Intents in full</strong>: Instead of returning an <code>Intent</code> entirely, filter it to include only necessary data and remove any unsafe flags</li><li><strong>Filter intent flags</strong>: Ensure that flags like <code>FLAG_GRANT_READ_URI_PERMISSION</code> and <code>FLAG_GRANT_WRITE_URI_PERMISSION</code> are handled securely</li><li><strong>Validate intent components</strong>: When an <code>Intent</code> is created from a URL in WebView, reset the component and selector fields</li><li><strong>Check if activity is exported</strong>: Before launching an activity from a URL-derived <code>Intent</code>, verify that the target activity is explicitly exported</li><li><strong>Don&rsquo;t export sensitive components</strong>: Avoid exporting components that access sensitive resources unless absolutely necessary</li><li><strong>Require permissions for sensitive tasks</strong>: For any exported component performing sensitive tasks, explicitly require appropriate permissions</li><li><strong>Apply signature-based permissions</strong>: When sharing data between your own ecosystem of apps, use <code>signature</code> protection level permissions</li><li><strong>Implement single-task endpoints</strong>: Design components to perform a small, specific set of tasks with granular privileges</li></ul><h3 class="relative group">9. SQL Injection in Shared Databases<div id=9-sql-injection-in-shared-databases class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#9-sql-injection-in-shared-databases aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-8 aria-label=Anchor>#</a></span></h4><ul><li>Multiple providers sharing same SQLite database</li><li>SQL injection in less secure provider affecting secure provider&rsquo;s data</li></ul><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-7 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>VulnerableContentProvider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>DatabaseHelper</span><span class=w> </span><span class=n>dbHelper</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>dbHelper</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DatabaseHelper</span><span class=p>(</span><span class=n>getContext</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>sortOrder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Vulnerable: Uses raw SQL with untrusted input</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>db</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dbHelper</span><span class=p>.</span><span class=na>getReadableDatabase</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>db</span><span class=p>.</span><span class=na>rawQuery</span><span class=p>(</span><span class=s>&#34;SELECT * FROM table WHERE &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Other required methods omitted for brevity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-8 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// SECURE: Use separate databases for different security levels</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecureProvider</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ContentProvider</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>SQLiteDatabase</span><span class=w> </span><span class=n>mSecureDb</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SQLiteOpenHelper</span><span class=w> </span><span class=n>helper</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MySecureDbHelper</span><span class=p>(</span><span class=n>getContext</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;secure.db&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>mSecureDb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>helper</span><span class=p>.</span><span class=na>getWritableDatabase</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Cursor</span><span class=w> </span><span class=nf>query</span><span class=p>(</span><span class=n>Uri</span><span class=w> </span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>sortOrder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Use parameterized queries</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SQLiteQueryBuilder</span><span class=w> </span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SQLiteQueryBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>builder</span><span class=p>.</span><span class=na>setStrict</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>builder</span><span class=p>.</span><span class=na>setStrictColumns</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>builder</span><span class=p>.</span><span class=na>setStrictGrammar</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=n>mSecureDb</span><span class=p>,</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>sortOrder</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">10. Zip Path Traversal (ZipSlip)<div id=10-zip-path-traversal-zipslip class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#10-zip-path-traversal-zipslip aria-label=Anchor>#</a></span></h3><h4 class="relative group">Vulnerability<div id=vulnerability-9 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerability-9 aria-label=Anchor>#</a></span></h4><p>When an Android app extracts files from compressed archives (like ZIP files), if the extraction logic doesn&rsquo;t validate the filenames within the archive for directory traversal characters (<code>../</code>), it can be vulnerable.</p><h4 class="relative group">Attack<div id=attack-5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attack-5 aria-label=Anchor>#</a></span></h4><p>An attacker crafts a malicious ZIP file where entries have filenames like <code>../../../../data/data/com.victim/files/sensitive.txt</code>. When the vulnerable app unpacks this archive, it could write arbitrary files to locations outside the intended destination directory, potentially overwriting application configuration files, databases, or even native libraries, leading to code execution.</p><h4 class="relative group">Vulnerable Code Example<div id=vulnerable-code-example-8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerable-code-example-8 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ZipExtractor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>extractZip</span><span class=p>(</span><span class=n>File</span><span class=w> </span><span class=n>zipFile</span><span class=p>,</span><span class=w> </span><span class=n>File</span><span class=w> </span><span class=n>outputDir</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ZipInputStream</span><span class=w> </span><span class=n>zis</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ZipInputStream</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>FileInputStream</span><span class=p>(</span><span class=n>zipFile</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ZipEntry</span><span class=w> </span><span class=n>entry</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>entry</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>zis</span><span class=p>.</span><span class=na>getNextEntry</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// Vulnerable: No validation of entry name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>entryName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>entry</span><span class=p>.</span><span class=na>getName</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>File</span><span class=w> </span><span class=n>outputFile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>File</span><span class=p>(</span><span class=n>outputDir</span><span class=p>,</span><span class=w> </span><span class=n>entryName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>OutputStream</span><span class=w> </span><span class=n>os</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FileOutputStream</span><span class=p>(</span><span class=n>outputFile</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>byte</span><span class=o>[</span><span class=n>1024</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>len</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>zis</span><span class=p>.</span><span class=na>read</span><span class=p>(</span><span class=n>buffer</span><span class=p>))</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>os</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>,</span><span class=w> </span><span class=n>len</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>os</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>zis</span><span class=p>.</span><span class=na>closeEntry</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>zis</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Mitigation<div id=mitigation-9 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#mitigation-9 aria-label=Anchor>#</a></span></h4><ul><li><strong>Verify target path is a child of destination directory</strong>: Before extracting each entry from a ZIP archive, always verify that the target path is a child of the intended destination directory by comparing their canonical paths</li><li><strong>Ensure destination directory is empty</strong>: To prevent accidentally overwriting existing files, make sure the extraction destination directory is empty before starting the extraction process</li></ul><h2 class="relative group">Security & Best Practices<div id=security--best-practices class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#security--best-practices aria-label=Anchor>#</a></span></h2><h3 class="relative group">Permission Strategy<div id=permission-strategy class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#permission-strategy aria-label=Anchor>#</a></span></h3><blockquote><p>[!IMPORTANT] Principle of Least Privilege Only request necessary permissions and avoid being &ldquo;overzealous&rdquo;. Users implicitly grant requested permissions during installation.</p></blockquote><h4 class="relative group">Restrict Access Through Permissions<div id=restrict-access-through-permissions class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#restrict-access-through-permissions aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- Example secure provider configuration --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;provider</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.SecureProvider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:authorities=</span><span class=s>&#34;com.example.secure.provider&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:exported=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:readPermission=</span><span class=s>&#34;com.example.permission.READ_DATA&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:writePermission=</span><span class=s>&#34;com.example.permission.WRITE_DATA&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Extra protection for sensitive paths --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;path-permission</span> 
</span></span><span class=line><span class=cl>        <span class=na>android:path=</span><span class=s>&#34;/admin/*&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:readPermission=</span><span class=s>&#34;com.example.permission.ADMIN_READ&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:writePermission=</span><span class=s>&#34;com.example.permission.ADMIN_WRITE&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/provider&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Define custom permissions --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;permission</span> 
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;com.example.permission.READ_DATA&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:protectionLevel=</span><span class=s>&#34;signature&#34;</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><h3 class="relative group">Secure Data Storage<div id=secure-data-storage class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#secure-data-storage aria-label=Anchor>#</a></span></h3><blockquote><p>[!WARNING] Keep Data Private Store data in <strong>internal files</strong>, <strong>SQLite databases</strong>, or <strong>cloud</strong> and keep these private to your application.</p></blockquote><ul><li><strong>Avoid world-readable/writable</strong>: Don&rsquo;t set internal files or SQLite databases to world-readable/writable</li><li><strong>SQLite databases are private by default</strong></li><li>This prevents permissions bypass</li></ul><h3 class="relative group">Prevent SQL Injection<div id=prevent-sql-injection class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#prevent-sql-injection aria-label=Anchor>#</a></span></h3><blockquote><p>[!DANGER] SQL Injection Prevention Always sanitize user input when querying, inserting, updating, or deleting data.</p></blockquote><p><strong>Recommended approach:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// SECURE: Use selection with replaceable parameters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;column = ?&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>selectionArgs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=s>&#34;user_input&#34;</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Cursor</span><span class=w> </span><span class=n>cursor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>resolver</span><span class=p>.</span><span class=na>query</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span><span class=w> </span><span class=n>projection</span><span class=p>,</span><span class=w> </span><span class=n>selection</span><span class=p>,</span><span class=w> </span><span class=n>selectionArgs</span><span class=p>,</span><span class=w> </span><span class=n>sortOrder</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// INSECURE: Direct string concatenation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>selection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;column = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>userInput</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>;</span><span class=w> </span><span class=c1>// DON&#39;T DO THIS!</span><span class=w>
</span></span></span></code></pre></div><p><strong>Additional protections:</strong></p><ul><li>Use <code>PreparedStatement</code> objects</li><li>Use Android&rsquo;s built-in <code>query()</code> methods</li><li>Configure <code>SQLiteQueryBuilder</code> with <code>setStrict()</code>, <code>setStrictColumns()</code>, <code>setStrictGrammar()</code></li><li>Consider <strong>Room Persistence Library</strong> for compile-time SQL verification</li></ul><h3 class="relative group">Implementation Best Practices<div id=implementation-best-practices class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#implementation-best-practices aria-label=Anchor>#</a></span></h3><h4 class="relative group">Thread Safety<div id=thread-safety class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#thread-safety aria-label=Anchor>#</a></span></h4><blockquote><p>[!NOTE] Thread Safety All <code>ContentProvider</code> methods except <code>onCreate()</code> can be called by multiple threads simultaneously - implementations must be thread-safe.</p></blockquote><h4 class="relative group">Efficient onCreate()<div id=efficient-oncreate class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#efficient-oncreate aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onCreate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Only fast-running initialization here</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Defer heavy tasks like database creation until needed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// This prevents slowing down provider startup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h4 class="relative group">Contract Classes<div id=contract-classes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#contract-classes aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Define constants in public final contract class</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyContract</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>AUTHORITY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;com.example.provider&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Uri</span><span class=w> </span><span class=n>BASE_URI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;content://&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>AUTHORITY</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Table contracts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>class</span> <span class=nc>Users</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>BaseColumns</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Uri</span><span class=w> </span><span class=n>URI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Uri</span><span class=p>.</span><span class=na>withAppendedPath</span><span class=p>(</span><span class=n>BASE_URI</span><span class=p>,</span><span class=w> </span><span class=s>&#34;users&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>TABLE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;users&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;name&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>COLUMN_EMAIL</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;email&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 class="relative group">In The end<div id=in-the-end class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#in-the-end aria-label=Anchor>#</a></span></h2><blockquote><p>[!TIP] Key Takeaways</p><ol><li><strong>Principle of Least Privilege</strong> - Only grant necessary permissions</li><li><strong>Defense in Depth</strong> - Multiple security layers (export, permissions, validation)</li><li><strong>Simplicity</strong> - Keep providers focused on data access only</li><li><strong>Validation</strong> - Always validate and sanitize input</li><li><strong>Separation</strong> - Isolate different security levels</li></ol></blockquote><h2 class="relative group">Resources<div id=resources class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#resources aria-label=Anchor>#</a></span></h2><h3 class="relative group">Documentation<div id=documentation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#documentation aria-label=Anchor>#</a></span></h3><ul><li><a href=https://developer.android.com/guide/topics/providers/content-providers target=_blank>Android Content Providers Guide</a></li><li><a href=https://developer.android.com/privacy-and-security/content-providers target=_blank>Content Provider Security</a></li><li><a href=https://developer.android.com/reference/androidx/core/content/FileProvider target=_blank>FileProvider Documentation</a></li></ul><h3 class="relative group">Security Resources<div id=security-resources class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#security-resources aria-label=Anchor>#</a></span></h3><ul><li><a href=https://owasp.org/www-project-mobile-security-testing-guide/ target=_blank>OWASP Mobile Security Testing Guide - Content Providers</a></li><li><a href=https://github.com/FSecureLABS/drozer target=_blank>drozer - Android Security Assessment Framework</a></li></ul><h3 class="relative group">Best Practices<div id=best-practices class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#best-practices aria-label=Anchor>#</a></span></h3><ul><li><a href=https://developer.android.com/privacy-and-security/security-tips target=_blank>Android Security Tips</a></li><li><a href=https://developer.android.com/privacy-and-security/security-tips#ContentProviders target=_blank>Secure Coding Guidelines</a></li></ul><hr><strong class="block mt-8"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:happyk1309@gmail.com?subject=Reply%20to%20Content%20%26%20File%20Providers">Reply by Email</a></strong></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Saeed Khalid" src=/superBLog/img/profile/theOne_hu_f3d25e422e0fbd54.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Saeed Khalid</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Just trying to have fun</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/happy-joyboy target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/saeed-khalid-awaad/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/0badsecurity0 target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.youtube.com/@joyboy_404 target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;title=Content%20&%20File%20Providers" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;text=Content%20&%20File%20Providers" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=Content%20&%20File%20Providers%20https://happy-joyboy.github.io/superBLog/posts/summary/providers/" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;resubmit=true&amp;title=Content%20&%20File%20Providers" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;quote=Content%20&%20File%20Providers" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;subject=Content%20&%20File%20Providers" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;resubmit=true&amp;title=Content%20&%20File%20Providers" title="Share via WhatsApp" aria-label="Share via WhatsApp"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://happy-joyboy.github.io/superBLog/posts/summary/providers/&amp;resubmit=true&amp;title=Content%20&%20File%20Providers" title="Share via Telegram" aria-label="Share via Telegram"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><a href=/superBLog/posts/ctf/mobile/hex/hex_provider/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/superBLog/posts/ctf/mobile/hex/hex_provider/featured_hu_ff63c610e17bb830.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/superBLog/posts/ctf/mobile/hex/hex_provider/>HEX Tree Content & File providers Challenges</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3749 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">18 mins</span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/ctf/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ctf
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/contnet-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Contnet Provider
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/file-provider/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">File Provider
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/hextree/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hextree</span></span></span></div></div><div class="py-1 prose dark:prose-invert"></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/superBLog/posts/summary/broadcast/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/superBLog/img/profile/justdoit_hu_257bd28ec3911a0f.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/superBLog/posts/summary/broadcast/>Broadcast</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3199 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">16 mins</span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/summary/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Summary
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/broadcast/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Broadcast</span></span></span></div></div><div class="py-1 prose dark:prose-invert"></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/superBLog/posts/summary/intents/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/superBLog/img/profile/justdoit_hu_257bd28ec3911a0f.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/superBLog/posts/summary/intents/>What is your (Intent)ion</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3947 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">19 mins</span></div><div class="flex flex-row flex-wrap items-center"><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/summary/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Summary
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/andorid/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Andorid
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/intent/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Intent
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/pending/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Pending
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/implicit/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Implicit
</span></span></span><span class="mr-2 mt-[0.5rem]" onclick='return window.open("/superBLog/tags/deep-links/","_self"),!1'><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Deep Links</span></span></span></div></div><div class="py-1 prose dark:prose-invert"></div></div><div class="px-6 pt-4 pb-2"></div></div></a></section></div><script type=text/javascript src=/superBLog/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/summary/providers/index.md data-oid-likes=likes_posts/summary/providers/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/superBLog/posts/first/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">First</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/superBLog/posts/summary/broadcast/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Broadcast</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-07-30T00:55:36+03:00>30 July 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/superBLog/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">Copy, _right? 🤔</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/superBLog/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://happy-joyboy.github.io/superBLog/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>